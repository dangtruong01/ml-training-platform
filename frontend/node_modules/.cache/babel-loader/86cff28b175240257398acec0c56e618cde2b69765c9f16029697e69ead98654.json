{"ast":null,"code":"var _jsxFileName = \"/Users/truonghaidang/Desktop/open-trainer/frontend/src/components/Annotate.js\";\nimport React, { useState, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Annotate() {\n  const [files, setFiles] = useState([]);\n  const [previews, setPreviews] = useState([]);\n  const [annotatedResults, setAnnotatedResults] = useState([]);\n  const [annotationType, setAnnotationType] = useState('detection');\n  const [isLoading, setIsLoading] = useState(false);\n  const [processingProgress, setProcessingProgress] = useState({\n    current: 0,\n    total: 0\n  });\n  const [batchId, setBatchId] = useState(null);\n\n  // GroundingDINO specific state\n  const [groundingDinoPrompts, setGroundingDinoPrompts] = useState('scratch, dent, dirt');\n  const [confidenceThreshold, setConfidenceThreshold] = useState(0.3);\n  const [groundingDinoAvailable, setGroundingDinoAvailable] = useState(false);\n\n  // Check GroundingDINO availability on component mount\n  useEffect(() => {\n    checkGroundingDinoStatus();\n  }, []);\n  const checkGroundingDinoStatus = async () => {\n    try {\n      const response = await fetch('/grounding-dino-status');\n      const data = await response.json();\n      setGroundingDinoAvailable(data.available);\n    } catch (error) {\n      console.error('Error checking GroundingDINO status:', error);\n      setGroundingDinoAvailable(false);\n    }\n  };\n  const handleFileChange = e => {\n    const selectedFiles = Array.from(e.target.files);\n    setFiles(selectedFiles);\n\n    // Create previews for all selected files\n    const newPreviews = selectedFiles.map(file => ({\n      file,\n      url: URL.createObjectURL(file),\n      name: file.name\n    }));\n    setPreviews(newPreviews);\n    setAnnotatedResults([]); // Reset results when new files are selected\n  };\n  const handleAnnotate = async () => {\n    if (files.length === 0) {\n      alert(\"Please select at least one file first.\");\n      return;\n    }\n    setIsLoading(true);\n    setProcessingProgress({\n      current: 0,\n      total: files.length\n    });\n    setAnnotatedResults([]);\n\n    // Generate unique batch ID\n    const newBatchId = `batch_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    setBatchId(newBatchId);\n    if (annotationType === 'grounding-dino') {\n      await handleGroundingDinoAnnotation(newBatchId);\n    } else {\n      await handleTraditionalAnnotation(newBatchId);\n    }\n  };\n  const handleGroundingDinoAnnotation = async newBatchId => {\n    try {\n      const formData = new FormData();\n      files.forEach(file => formData.append('files', file));\n      formData.append('prompts', groundingDinoPrompts);\n      formData.append('confidence_threshold', confidenceThreshold);\n      const response = await fetch('/grounding-dino-batch', {\n        method: 'POST',\n        body: formData\n      });\n      if (response.ok) {\n        const data = await response.json();\n        const results = data.results.map(result => ({\n          originalName: result.filename,\n          success: result.status === 'success',\n          annotatedUrl: result.status === 'success' ? `data:image/jpeg;base64,${result.image_base64}` : null,\n          error: result.status !== 'success' ? result.message : null,\n          detections: result.detections || [],\n          total_detections: result.total_detections || 0,\n          yolo_annotations: result.yolo_annotations\n        }));\n        setAnnotatedResults(results);\n      } else {\n        throw new Error('GroundingDINO batch annotation failed');\n      }\n    } catch (error) {\n      console.error('GroundingDINO annotation error:', error);\n      alert('GroundingDINO annotation failed. Please try again.');\n    } finally {\n      setIsLoading(false);\n      setProcessingProgress({\n        current: 0,\n        total: 0\n      });\n    }\n  };\n  const handleTraditionalAnnotation = async newBatchId => {\n    const endpointMap = {\n      'detection': '/pre-annotate-detect',\n      'segmentation': '/pre-annotate-segment',\n      'sam2-detection': '/pre-annotate-sam2-detect',\n      'sam2-segmentation': '/pre-annotate-sam2-segment'\n    };\n    const endpoint = endpointMap[annotationType] || '/pre-annotate-detect';\n    const results = [];\n    try {\n      for (let i = 0; i < files.length; i++) {\n        const file = files[i];\n        setProcessingProgress({\n          current: i + 1,\n          total: files.length\n        });\n        const formData = new FormData();\n        formData.append(\"file\", file);\n        formData.append(\"batch_id\", newBatchId); // Add batch ID for caching\n\n        try {\n          const response = await fetch(endpoint, {\n            method: \"POST\",\n            body: formData\n          });\n          if (response.ok) {\n            const imageBlob = await response.blob();\n            results.push({\n              originalName: file.name,\n              annotatedUrl: URL.createObjectURL(imageBlob),\n              success: true\n            });\n          } else {\n            results.push({\n              originalName: file.name,\n              success: false,\n              error: `${annotationType} annotation failed`\n            });\n          }\n        } catch (error) {\n          console.error(`Error processing ${file.name}:`, error);\n          results.push({\n            originalName: file.name,\n            success: false,\n            error: \"Processing error\"\n          });\n        }\n      }\n      setAnnotatedResults(results);\n    } catch (error) {\n      console.error(\"Error during batch annotation:\", error);\n      alert(\"An error occurred during batch annotation.\");\n    } finally {\n      setIsLoading(false);\n      setProcessingProgress({\n        current: 0,\n        total: 0\n      });\n    }\n  };\n  const handleDownloadZip = async () => {\n    const successfulResults = annotatedResults.filter(result => result.success);\n    if (successfulResults.length === 0) {\n      alert(\"No successful annotations to download.\");\n      return;\n    }\n    try {\n      const response = await fetch(`/download-batch-zip/${batchId}`, {\n        method: 'POST'\n      });\n      if (response.ok) {\n        const blob = await response.blob();\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.style.display = 'none';\n        a.href = url;\n        a.download = `annotated_${annotationType}_batch.zip`;\n        document.body.appendChild(a);\n        a.click();\n        window.URL.revokeObjectURL(url);\n        document.body.removeChild(a);\n      } else {\n        throw new Error('Failed to download zip file');\n      }\n    } catch (error) {\n      console.error('Error downloading zip:', error);\n      alert('Failed to download zip file. Please try again.');\n    }\n  };\n  const handleExportYoloDataset = async () => {\n    const groundingDinoResults = annotatedResults.filter(result => result.success && result.yolo_annotations);\n    if (groundingDinoResults.length === 0) {\n      alert(\"No GroundingDINO results to export.\");\n      return;\n    }\n    try {\n      const formData = new FormData();\n      formData.append('annotation_results', JSON.stringify(groundingDinoResults));\n      formData.append('dataset_name', `grounding_dino_${Date.now()}`);\n      const response = await fetch('/grounding-dino-export-yolo', {\n        method: 'POST',\n        body: formData\n      });\n      if (response.ok) {\n        const data = await response.json();\n        alert(`YOLO dataset exported successfully: ${data.dataset_name}`);\n      } else {\n        throw new Error('Failed to export dataset');\n      }\n    } catch (error) {\n      console.error('Error exporting dataset:', error);\n      alert('Failed to export YOLO dataset.');\n    }\n  };\n  const renderAnnotationTypeSelector = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      marginBottom: '20px'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"\\uD83C\\uDFAF Annotation Method\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'grid',\n        gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',\n        gap: '10px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          padding: '10px',\n          border: '2px solid #e2e8f0',\n          borderRadius: '8px',\n          backgroundColor: annotationType === 'detection' ? '#dbeafe' : 'white',\n          borderColor: annotationType === 'detection' ? '#3b82f6' : '#e2e8f0',\n          cursor: 'pointer'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"radio\",\n          value: \"detection\",\n          checked: annotationType === 'detection',\n          onChange: e => setAnnotationType(e.target.value),\n          style: {\n            marginRight: '8px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\uD83D\\uDCE6 OpenCV Detection\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          padding: '10px',\n          border: '2px solid #e2e8f0',\n          borderRadius: '8px',\n          backgroundColor: annotationType === 'segmentation' ? '#dbeafe' : 'white',\n          borderColor: annotationType === 'segmentation' ? '#3b82f6' : '#e2e8f0',\n          cursor: 'pointer'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"radio\",\n          value: \"segmentation\",\n          checked: annotationType === 'segmentation',\n          onChange: e => setAnnotationType(e.target.value),\n          style: {\n            marginRight: '8px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\u2702\\uFE0F OpenCV Segmentation\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 272,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          padding: '10px',\n          border: '2px solid #e2e8f0',\n          borderRadius: '8px',\n          backgroundColor: annotationType === 'sam2-detection' ? '#dbeafe' : 'white',\n          borderColor: annotationType === 'sam2-detection' ? '#3b82f6' : '#e2e8f0',\n          cursor: 'pointer'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"radio\",\n          value: \"sam2-detection\",\n          checked: annotationType === 'sam2-detection',\n          onChange: e => setAnnotationType(e.target.value),\n          style: {\n            marginRight: '8px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\uD83C\\uDFAF SAM2 Detection\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          padding: '10px',\n          border: '2px solid #e2e8f0',\n          borderRadius: '8px',\n          backgroundColor: annotationType === 'sam2-segmentation' ? '#dbeafe' : 'white',\n          borderColor: annotationType === 'sam2-segmentation' ? '#3b82f6' : '#e2e8f0',\n          cursor: 'pointer'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"radio\",\n          value: \"sam2-segmentation\",\n          checked: annotationType === 'sam2-segmentation',\n          onChange: e => setAnnotationType(e.target.value),\n          style: {\n            marginRight: '8px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\uD83D\\uDD2A SAM2 Segmentation\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 17\n      }, this), groundingDinoAvailable && /*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          padding: '10px',\n          border: '2px solid #10b981',\n          borderRadius: '8px',\n          backgroundColor: annotationType === 'grounding-dino' ? '#d1fae5' : 'white',\n          borderColor: annotationType === 'grounding-dino' ? '#10b981' : '#10b981',\n          cursor: 'pointer'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"radio\",\n          value: \"grounding-dino\",\n          checked: annotationType === 'grounding-dino',\n          onChange: e => setAnnotationType(e.target.value),\n          style: {\n            marginRight: '8px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\u2728 GroundingDINO (AI-Powered)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 13\n    }, this), !groundingDinoAvailable && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: '10px',\n        padding: '10px',\n        backgroundColor: '#fef3c7',\n        border: '1px solid #f59e0b',\n        borderRadius: '4px',\n        fontSize: '14px'\n      },\n      children: \"\\u26A0\\uFE0F GroundingDINO not available. Please install dependencies to use AI-powered annotation.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 339,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 232,\n    columnNumber: 9\n  }, this);\n  const renderGroundingDinoOptions = () => {\n    if (annotationType !== 'grounding-dino') return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: '20px',\n        padding: '20px',\n        backgroundColor: '#f0fdf4',\n        border: '1px solid #10b981',\n        borderRadius: '8px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        style: {\n          margin: '0 0 15px 0',\n          color: '#059669'\n        },\n        children: \"\\u2728 GroundingDINO Settings\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 364,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: '15px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: 'block',\n            marginBottom: '5px',\n            fontWeight: 'bold'\n          },\n          children: \"Defect Prompts (comma-separated):\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 367,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: groundingDinoPrompts,\n          onChange: e => setGroundingDinoPrompts(e.target.value),\n          placeholder: \"e.g., scratch, dent, dirt, corrosion, crack\",\n          style: {\n            width: '100%',\n            padding: '8px',\n            border: '1px solid #d1d5db',\n            borderRadius: '4px',\n            fontSize: '14px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '12px',\n            color: '#6b7280',\n            marginTop: '5px'\n          },\n          children: \"Describe the defects you want to detect. Be specific (e.g., \\\"scratch on metal surface\\\").\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 366,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: '15px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: 'block',\n            marginBottom: '5px',\n            fontWeight: 'bold'\n          },\n          children: [\"Confidence Threshold: \", confidenceThreshold]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 389,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"range\",\n          min: \"0.1\",\n          max: \"0.9\",\n          step: \"0.1\",\n          value: confidenceThreshold,\n          onChange: e => setConfidenceThreshold(parseFloat(e.target.value)),\n          style: {\n            width: '200px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 392,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '12px',\n            color: '#6b7280',\n            marginTop: '5px'\n          },\n          children: \"Lower values detect more objects but may include false positives.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 401,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 388,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 357,\n      columnNumber: 13\n    }, this);\n  };\n  const renderResults = () => {\n    if (annotatedResults.length === 0) return null;\n    const successfulResults = annotatedResults.filter(result => result.success);\n    const failedResults = annotatedResults.filter(result => !result.success);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: '30px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          marginBottom: '20px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\uD83D\\uDCCA Annotation Results\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 418,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            gap: '10px'\n          },\n          children: [successfulResults.length > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleDownloadZip,\n            style: {\n              backgroundColor: '#059669',\n              color: 'white',\n              padding: '8px 16px',\n              border: 'none',\n              borderRadius: '4px',\n              cursor: 'pointer'\n            },\n            children: \"\\uD83D\\uDCE5 Download ZIP\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 421,\n            columnNumber: 29\n          }, this), annotationType === 'grounding-dino' && successfulResults.some(r => r.yolo_annotations) && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleExportYoloDataset,\n            style: {\n              backgroundColor: '#7c3aed',\n              color: 'white',\n              padding: '8px 16px',\n              border: 'none',\n              borderRadius: '4px',\n              cursor: 'pointer'\n            },\n            children: \"\\uD83D\\uDCE6 Export YOLO Dataset\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 436,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 419,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'grid',\n          gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))',\n          gap: '20px',\n          marginBottom: '20px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: '15px',\n            backgroundColor: '#dcfce7',\n            border: '1px solid #86efac',\n            borderRadius: '8px'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '18px',\n              fontWeight: 'bold',\n              color: '#059669'\n            },\n            children: [\"\\u2705 Successful: \", successfulResults.length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 465,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: '15px',\n            backgroundColor: '#fee2e2',\n            border: '1px solid #fca5a5',\n            borderRadius: '8px'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '18px',\n              fontWeight: 'bold',\n              color: '#dc2626'\n            },\n            children: [\"\\u274C Failed: \", failedResults.length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 475,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 469,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 453,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'grid',\n          gridTemplateColumns: 'repeat(auto-fit, minmax(400px, 1fr))',\n          gap: '20px'\n        },\n        children: annotatedResults.map((result, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            border: '1px solid #e2e8f0',\n            borderRadius: '8px',\n            padding: '15px',\n            backgroundColor: result.success ? '#f9fafb' : '#fef2f2'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            style: {\n              margin: '0 0 10px 0'\n            },\n            children: result.originalName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 489,\n            columnNumber: 29\n          }, this), result.success ? /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: result.annotatedUrl,\n              alt: `Annotated ${result.originalName}`,\n              style: {\n                width: '100%',\n                borderRadius: '4px',\n                marginBottom: '10px'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 493,\n              columnNumber: 37\n            }, this), result.detections && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '14px',\n                color: '#6b7280'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Detections:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 501,\n                columnNumber: 45\n              }, this), \" \", result.total_detections || result.detections.length, result.detections.map((detection, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  marginLeft: '10px',\n                  fontSize: '12px'\n                },\n                children: [\"\\u2022 \", detection.class, \": \", (detection.confidence * 100).toFixed(1), \"%\"]\n              }, idx, true, {\n                fileName: _jsxFileName,\n                lineNumber: 503,\n                columnNumber: 49\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 500,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 492,\n            columnNumber: 33\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              color: '#dc2626'\n            },\n            children: [\"Error: \", result.error]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 511,\n            columnNumber: 33\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 483,\n          columnNumber: 25\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 481,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 416,\n      columnNumber: 13\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: '20px',\n      maxWidth: '1200px',\n      margin: '0 auto'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\uD83C\\uDFF7\\uFE0F Image Annotation\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 524,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: '20px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          display: 'block',\n          marginBottom: '10px',\n          fontSize: '16px',\n          fontWeight: 'bold'\n        },\n        children: \"\\uD83D\\uDCC1 Select Images:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 527,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        multiple: true,\n        accept: \"image/*\",\n        onChange: handleFileChange,\n        style: {\n          padding: '10px',\n          border: '2px dashed #d1d5db',\n          borderRadius: '8px',\n          width: '100%',\n          cursor: 'pointer'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 530,\n        columnNumber: 17\n      }, this), files.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '10px',\n          fontSize: '14px',\n          color: '#059669'\n        },\n        children: [\"\\u2705 \", files.length, \" image(s) selected\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 544,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 526,\n      columnNumber: 13\n    }, this), renderAnnotationTypeSelector(), renderGroundingDinoOptions(), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: '30px'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleAnnotate,\n        disabled: files.length === 0 || isLoading,\n        style: {\n          backgroundColor: files.length === 0 || isLoading ? '#9ca3af' : '#1e3a8a',\n          color: 'white',\n          padding: '12px 24px',\n          border: 'none',\n          borderRadius: '8px',\n          fontSize: '16px',\n          cursor: files.length === 0 || isLoading ? 'not-allowed' : 'pointer'\n        },\n        children: isLoading ? `🔄 Processing... (${processingProgress.current}/${processingProgress.total})` : '🚀 Start Annotation'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 554,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 553,\n      columnNumber: 13\n    }, this), renderResults()]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 523,\n    columnNumber: 9\n  }, this);\n}\nexport default Annotate;","map":{"version":3,"names":["React","useState","useEffect","jsxDEV","_jsxDEV","Annotate","files","setFiles","previews","setPreviews","annotatedResults","setAnnotatedResults","annotationType","setAnnotationType","isLoading","setIsLoading","processingProgress","setProcessingProgress","current","total","batchId","setBatchId","groundingDinoPrompts","setGroundingDinoPrompts","confidenceThreshold","setConfidenceThreshold","groundingDinoAvailable","setGroundingDinoAvailable","checkGroundingDinoStatus","response","fetch","data","json","available","error","console","handleFileChange","e","selectedFiles","Array","from","target","newPreviews","map","file","url","URL","createObjectURL","name","handleAnnotate","length","alert","newBatchId","Date","now","Math","random","toString","substr","handleGroundingDinoAnnotation","handleTraditionalAnnotation","formData","FormData","forEach","append","method","body","ok","results","result","originalName","filename","success","status","annotatedUrl","image_base64","message","detections","total_detections","yolo_annotations","Error","endpointMap","endpoint","i","imageBlob","blob","push","handleDownloadZip","successfulResults","filter","window","a","document","createElement","style","display","href","download","appendChild","click","revokeObjectURL","removeChild","handleExportYoloDataset","groundingDinoResults","JSON","stringify","dataset_name","renderAnnotationTypeSelector","marginBottom","children","fileName","_jsxFileName","lineNumber","columnNumber","gridTemplateColumns","gap","alignItems","padding","border","borderRadius","backgroundColor","borderColor","cursor","type","value","checked","onChange","marginRight","marginTop","fontSize","renderGroundingDinoOptions","margin","color","fontWeight","placeholder","width","min","max","step","parseFloat","renderResults","failedResults","justifyContent","onClick","some","r","index","src","alt","detection","idx","marginLeft","class","confidence","toFixed","maxWidth","multiple","accept","disabled"],"sources":["/Users/truonghaidang/Desktop/open-trainer/frontend/src/components/Annotate.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\n\nfunction Annotate() {\n    const [files, setFiles] = useState([]);\n    const [previews, setPreviews] = useState([]);\n    const [annotatedResults, setAnnotatedResults] = useState([]);\n    const [annotationType, setAnnotationType] = useState('detection');\n    const [isLoading, setIsLoading] = useState(false);\n    const [processingProgress, setProcessingProgress] = useState({ current: 0, total: 0 });\n    const [batchId, setBatchId] = useState(null);\n    \n    // GroundingDINO specific state\n    const [groundingDinoPrompts, setGroundingDinoPrompts] = useState('scratch, dent, dirt');\n    const [confidenceThreshold, setConfidenceThreshold] = useState(0.3);\n    const [groundingDinoAvailable, setGroundingDinoAvailable] = useState(false);\n\n    // Check GroundingDINO availability on component mount\n    useEffect(() => {\n        checkGroundingDinoStatus();\n    }, []);\n\n    const checkGroundingDinoStatus = async () => {\n        try {\n            const response = await fetch('/grounding-dino-status');\n            const data = await response.json();\n            setGroundingDinoAvailable(data.available);\n        } catch (error) {\n            console.error('Error checking GroundingDINO status:', error);\n            setGroundingDinoAvailable(false);\n        }\n    };\n\n    const handleFileChange = (e) => {\n        const selectedFiles = Array.from(e.target.files);\n        setFiles(selectedFiles);\n        \n        // Create previews for all selected files\n        const newPreviews = selectedFiles.map(file => ({\n            file,\n            url: URL.createObjectURL(file),\n            name: file.name\n        }));\n        setPreviews(newPreviews);\n        setAnnotatedResults([]); // Reset results when new files are selected\n    };\n\n    const handleAnnotate = async () => {\n        if (files.length === 0) {\n            alert(\"Please select at least one file first.\");\n            return;\n        }\n\n        setIsLoading(true);\n        setProcessingProgress({ current: 0, total: files.length });\n        setAnnotatedResults([]);\n\n        // Generate unique batch ID\n        const newBatchId = `batch_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n        setBatchId(newBatchId);\n\n        if (annotationType === 'grounding-dino') {\n            await handleGroundingDinoAnnotation(newBatchId);\n        } else {\n            await handleTraditionalAnnotation(newBatchId);\n        }\n    };\n\n    const handleGroundingDinoAnnotation = async (newBatchId) => {\n        try {\n            const formData = new FormData();\n            files.forEach(file => formData.append('files', file));\n            formData.append('prompts', groundingDinoPrompts);\n            formData.append('confidence_threshold', confidenceThreshold);\n\n            const response = await fetch('/grounding-dino-batch', {\n                method: 'POST',\n                body: formData\n            });\n\n            if (response.ok) {\n                const data = await response.json();\n                \n                const results = data.results.map(result => ({\n                    originalName: result.filename,\n                    success: result.status === 'success',\n                    annotatedUrl: result.status === 'success' ? `data:image/jpeg;base64,${result.image_base64}` : null,\n                    error: result.status !== 'success' ? result.message : null,\n                    detections: result.detections || [],\n                    total_detections: result.total_detections || 0,\n                    yolo_annotations: result.yolo_annotations\n                }));\n\n                setAnnotatedResults(results);\n            } else {\n                throw new Error('GroundingDINO batch annotation failed');\n            }\n        } catch (error) {\n            console.error('GroundingDINO annotation error:', error);\n            alert('GroundingDINO annotation failed. Please try again.');\n        } finally {\n            setIsLoading(false);\n            setProcessingProgress({ current: 0, total: 0 });\n        }\n    };\n\n    const handleTraditionalAnnotation = async (newBatchId) => {\n        const endpointMap = {\n            'detection': '/pre-annotate-detect',\n            'segmentation': '/pre-annotate-segment',\n            'sam2-detection': '/pre-annotate-sam2-detect',\n            'sam2-segmentation': '/pre-annotate-sam2-segment'\n        };\n        const endpoint = endpointMap[annotationType] || '/pre-annotate-detect';\n\n        const results = [];\n\n        try {\n            for (let i = 0; i < files.length; i++) {\n                const file = files[i];\n                setProcessingProgress({ current: i + 1, total: files.length });\n\n                const formData = new FormData();\n                formData.append(\"file\", file);\n                formData.append(\"batch_id\", newBatchId); // Add batch ID for caching\n\n                try {\n                    const response = await fetch(endpoint, {\n                        method: \"POST\",\n                        body: formData,\n                    });\n\n                    if (response.ok) {\n                        const imageBlob = await response.blob();\n                        results.push({\n                            originalName: file.name,\n                            annotatedUrl: URL.createObjectURL(imageBlob),\n                            success: true\n                        });\n                    } else {\n                        results.push({\n                            originalName: file.name,\n                            success: false,\n                            error: `${annotationType} annotation failed`\n                        });\n                    }\n                } catch (error) {\n                    console.error(`Error processing ${file.name}:`, error);\n                    results.push({\n                        originalName: file.name,\n                        success: false,\n                        error: \"Processing error\"\n                    });\n                }\n            }\n\n            setAnnotatedResults(results);\n        } catch (error) {\n            console.error(\"Error during batch annotation:\", error);\n            alert(\"An error occurred during batch annotation.\");\n        } finally {\n            setIsLoading(false);\n            setProcessingProgress({ current: 0, total: 0 });\n        }\n    };\n\n    const handleDownloadZip = async () => {\n        const successfulResults = annotatedResults.filter(result => result.success);\n        \n        if (successfulResults.length === 0) {\n            alert(\"No successful annotations to download.\");\n            return;\n        }\n\n        try {\n            const response = await fetch(`/download-batch-zip/${batchId}`, {\n                method: 'POST',\n            });\n\n            if (response.ok) {\n                const blob = await response.blob();\n                const url = window.URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.style.display = 'none';\n                a.href = url;\n                a.download = `annotated_${annotationType}_batch.zip`;\n                document.body.appendChild(a);\n                a.click();\n                window.URL.revokeObjectURL(url);\n                document.body.removeChild(a);\n            } else {\n                throw new Error('Failed to download zip file');\n            }\n        } catch (error) {\n            console.error('Error downloading zip:', error);\n            alert('Failed to download zip file. Please try again.');\n        }\n    };\n\n    const handleExportYoloDataset = async () => {\n        const groundingDinoResults = annotatedResults.filter(result => \n            result.success && result.yolo_annotations\n        );\n\n        if (groundingDinoResults.length === 0) {\n            alert(\"No GroundingDINO results to export.\");\n            return;\n        }\n\n        try {\n            const formData = new FormData();\n            formData.append('annotation_results', JSON.stringify(groundingDinoResults));\n            formData.append('dataset_name', `grounding_dino_${Date.now()}`);\n\n            const response = await fetch('/grounding-dino-export-yolo', {\n                method: 'POST',\n                body: formData\n            });\n\n            if (response.ok) {\n                const data = await response.json();\n                alert(`YOLO dataset exported successfully: ${data.dataset_name}`);\n            } else {\n                throw new Error('Failed to export dataset');\n            }\n        } catch (error) {\n            console.error('Error exporting dataset:', error);\n            alert('Failed to export YOLO dataset.');\n        }\n    };\n\n    const renderAnnotationTypeSelector = () => (\n        <div style={{ marginBottom: '20px' }}>\n            <h3>🎯 Annotation Method</h3>\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '10px' }}>\n                <label style={{ \n                    display: 'flex', \n                    alignItems: 'center',\n                    padding: '10px',\n                    border: '2px solid #e2e8f0',\n                    borderRadius: '8px',\n                    backgroundColor: annotationType === 'detection' ? '#dbeafe' : 'white',\n                    borderColor: annotationType === 'detection' ? '#3b82f6' : '#e2e8f0',\n                    cursor: 'pointer'\n                }}>\n                    <input\n                        type=\"radio\"\n                        value=\"detection\"\n                        checked={annotationType === 'detection'}\n                        onChange={(e) => setAnnotationType(e.target.value)}\n                        style={{ marginRight: '8px' }}\n                    />\n                    <span>📦 OpenCV Detection</span>\n                </label>\n\n                <label style={{\n                    display: 'flex', \n                    alignItems: 'center',\n                    padding: '10px',\n                    border: '2px solid #e2e8f0',\n                    borderRadius: '8px',\n                    backgroundColor: annotationType === 'segmentation' ? '#dbeafe' : 'white',\n                    borderColor: annotationType === 'segmentation' ? '#3b82f6' : '#e2e8f0',\n                    cursor: 'pointer'\n                }}>\n                    <input\n                        type=\"radio\"\n                        value=\"segmentation\"\n                        checked={annotationType === 'segmentation'}\n                        onChange={(e) => setAnnotationType(e.target.value)}\n                        style={{ marginRight: '8px' }}\n                    />\n                    <span>✂️ OpenCV Segmentation</span>\n                </label>\n\n                <label style={{\n                    display: 'flex', \n                    alignItems: 'center',\n                    padding: '10px',\n                    border: '2px solid #e2e8f0',\n                    borderRadius: '8px',\n                    backgroundColor: annotationType === 'sam2-detection' ? '#dbeafe' : 'white',\n                    borderColor: annotationType === 'sam2-detection' ? '#3b82f6' : '#e2e8f0',\n                    cursor: 'pointer'\n                }}>\n                    <input\n                        type=\"radio\"\n                        value=\"sam2-detection\"\n                        checked={annotationType === 'sam2-detection'}\n                        onChange={(e) => setAnnotationType(e.target.value)}\n                        style={{ marginRight: '8px' }}\n                    />\n                    <span>🎯 SAM2 Detection</span>\n                </label>\n\n                <label style={{\n                    display: 'flex', \n                    alignItems: 'center',\n                    padding: '10px',\n                    border: '2px solid #e2e8f0',\n                    borderRadius: '8px',\n                    backgroundColor: annotationType === 'sam2-segmentation' ? '#dbeafe' : 'white',\n                    borderColor: annotationType === 'sam2-segmentation' ? '#3b82f6' : '#e2e8f0',\n                    cursor: 'pointer'\n                }}>\n                    <input\n                        type=\"radio\"\n                        value=\"sam2-segmentation\"\n                        checked={annotationType === 'sam2-segmentation'}\n                        onChange={(e) => setAnnotationType(e.target.value)}\n                        style={{ marginRight: '8px' }}\n                    />\n                    <span>🔪 SAM2 Segmentation</span>\n                </label>\n\n                {groundingDinoAvailable && (\n                    <label style={{\n                        display: 'flex', \n                        alignItems: 'center',\n                        padding: '10px',\n                        border: '2px solid #10b981',\n                        borderRadius: '8px',\n                        backgroundColor: annotationType === 'grounding-dino' ? '#d1fae5' : 'white',\n                        borderColor: annotationType === 'grounding-dino' ? '#10b981' : '#10b981',\n                        cursor: 'pointer'\n                    }}>\n                        <input\n                            type=\"radio\"\n                            value=\"grounding-dino\"\n                            checked={annotationType === 'grounding-dino'}\n                            onChange={(e) => setAnnotationType(e.target.value)}\n                            style={{ marginRight: '8px' }}\n                        />\n                        <span>✨ GroundingDINO (AI-Powered)</span>\n                    </label>\n                )}\n            </div>\n\n            {!groundingDinoAvailable && (\n                <div style={{ \n                    marginTop: '10px', \n                    padding: '10px', \n                    backgroundColor: '#fef3c7', \n                    border: '1px solid #f59e0b',\n                    borderRadius: '4px',\n                    fontSize: '14px'\n                }}>\n                    ⚠️ GroundingDINO not available. Please install dependencies to use AI-powered annotation.\n                </div>\n            )}\n        </div>\n    );\n\n    const renderGroundingDinoOptions = () => {\n        if (annotationType !== 'grounding-dino') return null;\n\n        return (\n            <div style={{\n                marginBottom: '20px',\n                padding: '20px',\n                backgroundColor: '#f0fdf4',\n                border: '1px solid #10b981',\n                borderRadius: '8px'\n            }}>\n                <h4 style={{ margin: '0 0 15px 0', color: '#059669' }}>✨ GroundingDINO Settings</h4>\n                \n                <div style={{ marginBottom: '15px' }}>\n                    <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\n                        Defect Prompts (comma-separated):\n                    </label>\n                    <input\n                        type=\"text\"\n                        value={groundingDinoPrompts}\n                        onChange={(e) => setGroundingDinoPrompts(e.target.value)}\n                        placeholder=\"e.g., scratch, dent, dirt, corrosion, crack\"\n                        style={{ \n                            width: '100%', \n                            padding: '8px', \n                            border: '1px solid #d1d5db',\n                            borderRadius: '4px',\n                            fontSize: '14px'\n                        }}\n                    />\n                    <div style={{ fontSize: '12px', color: '#6b7280', marginTop: '5px' }}>\n                        Describe the defects you want to detect. Be specific (e.g., \"scratch on metal surface\").\n                    </div>\n                </div>\n\n                <div style={{ marginBottom: '15px' }}>\n                    <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\n                        Confidence Threshold: {confidenceThreshold}\n                    </label>\n                    <input\n                        type=\"range\"\n                        min=\"0.1\"\n                        max=\"0.9\"\n                        step=\"0.1\"\n                        value={confidenceThreshold}\n                        onChange={(e) => setConfidenceThreshold(parseFloat(e.target.value))}\n                        style={{ width: '200px' }}\n                    />\n                    <div style={{ fontSize: '12px', color: '#6b7280', marginTop: '5px' }}>\n                        Lower values detect more objects but may include false positives.\n                    </div>\n                </div>\n            </div>\n        );\n    };\n\n    const renderResults = () => {\n        if (annotatedResults.length === 0) return null;\n\n        const successfulResults = annotatedResults.filter(result => result.success);\n        const failedResults = annotatedResults.filter(result => !result.success);\n\n        return (\n            <div style={{ marginTop: '30px' }}>\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>\n                    <h3>📊 Annotation Results</h3>\n                    <div style={{ display: 'flex', gap: '10px' }}>\n                        {successfulResults.length > 0 && (\n                            <button \n                                onClick={handleDownloadZip}\n                                style={{\n                                    backgroundColor: '#059669',\n                                    color: 'white',\n                                    padding: '8px 16px',\n                                    border: 'none',\n                                    borderRadius: '4px',\n                                    cursor: 'pointer'\n                                }}\n                            >\n                                📥 Download ZIP\n                            </button>\n                        )}\n                        {annotationType === 'grounding-dino' && successfulResults.some(r => r.yolo_annotations) && (\n                            <button \n                                onClick={handleExportYoloDataset}\n                                style={{\n                                    backgroundColor: '#7c3aed',\n                                    color: 'white',\n                                    padding: '8px 16px',\n                                    border: 'none',\n                                    borderRadius: '4px',\n                                    cursor: 'pointer'\n                                }}\n                            >\n                                📦 Export YOLO Dataset\n                            </button>\n                        )}\n                    </div>\n                </div>\n\n                <div style={{ \n                    display: 'grid', \n                    gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', \n                    gap: '20px',\n                    marginBottom: '20px'\n                }}>\n                    <div style={{\n                        padding: '15px',\n                        backgroundColor: '#dcfce7',\n                        border: '1px solid #86efac',\n                        borderRadius: '8px'\n                    }}>\n                        <div style={{ fontSize: '18px', fontWeight: 'bold', color: '#059669' }}>\n                            ✅ Successful: {successfulResults.length}\n                        </div>\n                    </div>\n                    <div style={{\n                        padding: '15px',\n                        backgroundColor: '#fee2e2',\n                        border: '1px solid #fca5a5',\n                        borderRadius: '8px'\n                    }}>\n                        <div style={{ fontSize: '18px', fontWeight: 'bold', color: '#dc2626' }}>\n                            ❌ Failed: {failedResults.length}\n                        </div>\n                    </div>\n                </div>\n\n                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(400px, 1fr))', gap: '20px' }}>\n                    {annotatedResults.map((result, index) => (\n                        <div key={index} style={{ \n                            border: '1px solid #e2e8f0', \n                            borderRadius: '8px', \n                            padding: '15px',\n                            backgroundColor: result.success ? '#f9fafb' : '#fef2f2'\n                        }}>\n                            <h4 style={{ margin: '0 0 10px 0' }}>{result.originalName}</h4>\n                            \n                            {result.success ? (\n                                <div>\n                                    <img \n                                        src={result.annotatedUrl} \n                                        alt={`Annotated ${result.originalName}`} \n                                        style={{ width: '100%', borderRadius: '4px', marginBottom: '10px' }}\n                                    />\n                                    \n                                    {result.detections && (\n                                        <div style={{ fontSize: '14px', color: '#6b7280' }}>\n                                            <strong>Detections:</strong> {result.total_detections || result.detections.length}\n                                            {result.detections.map((detection, idx) => (\n                                                <div key={idx} style={{ marginLeft: '10px', fontSize: '12px' }}>\n                                                    • {detection.class}: {(detection.confidence * 100).toFixed(1)}%\n                                                </div>\n                                            ))}\n                                        </div>\n                                    )}\n                                </div>\n                            ) : (\n                                <div style={{ color: '#dc2626' }}>\n                                    Error: {result.error}\n                                </div>\n                            )}\n                        </div>\n                    ))}\n                </div>\n            </div>\n        );\n    };\n\n    return (\n        <div style={{ padding: '20px', maxWidth: '1200px', margin: '0 auto' }}>\n            <h2>🏷️ Image Annotation</h2>\n            \n            <div style={{ marginBottom: '20px' }}>\n                <label style={{ display: 'block', marginBottom: '10px', fontSize: '16px', fontWeight: 'bold' }}>\n                    📁 Select Images:\n                </label>\n                <input \n                    type=\"file\" \n                    multiple \n                    accept=\"image/*\"\n                    onChange={handleFileChange}\n                    style={{ \n                        padding: '10px',\n                        border: '2px dashed #d1d5db',\n                        borderRadius: '8px',\n                        width: '100%',\n                        cursor: 'pointer'\n                    }}\n                />\n                {files.length > 0 && (\n                    <div style={{ marginTop: '10px', fontSize: '14px', color: '#059669' }}>\n                        ✅ {files.length} image(s) selected\n                    </div>\n                )}\n            </div>\n\n            {renderAnnotationTypeSelector()}\n            {renderGroundingDinoOptions()}\n\n            <div style={{ marginBottom: '30px' }}>\n                <button \n                    onClick={handleAnnotate}\n                    disabled={files.length === 0 || isLoading}\n                    style={{\n                        backgroundColor: files.length === 0 || isLoading ? '#9ca3af' : '#1e3a8a',\n                        color: 'white',\n                        padding: '12px 24px',\n                        border: 'none',\n                        borderRadius: '8px',\n                        fontSize: '16px',\n                        cursor: files.length === 0 || isLoading ? 'not-allowed' : 'pointer'\n                    }}\n                >\n                    {isLoading ? `🔄 Processing... (${processingProgress.current}/${processingProgress.total})` : '🚀 Start Annotation'}\n                </button>\n            </div>\n\n            {renderResults()}\n        </div>\n    );\n}\n\nexport default Annotate;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}