{"ast":null,"code":"var _jsxFileName = \"/Users/truonghaidang/Desktop/open-trainer/frontend/src/components/Annotate.js\";\nimport React, { useState, useEffect } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Annotate() {\n  const [files, setFiles] = useState([]);\n  const [previews, setPreviews] = useState([]);\n  const [annotatedResults, setAnnotatedResults] = useState([]);\n  const [annotationType, setAnnotationType] = useState('detection');\n  const [isLoading, setIsLoading] = useState(false);\n  const [processingProgress, setProcessingProgress] = useState({\n    current: 0,\n    total: 0\n  });\n  const [batchId, setBatchId] = useState(null);\n\n  // GroundingDINO specific state\n  const [groundingDinoPrompts, setGroundingDinoPrompts] = useState('scratch, dent, dirt');\n  const [confidenceThreshold, setConfidenceThreshold] = useState(0.3);\n  const [groundingDinoAvailable, setGroundingDinoAvailable] = useState(false);\n\n  // Guardrail (Anomaly Detection + Classification) specific state\n  const [guardrailModelFile, setGuardrailModelFile] = useState(null);\n  const [guardrailPrompts, setGuardrailPrompts] = useState('scratch, dent, dirt');\n  const [guardrailConfidenceThreshold, setGuardrailConfidenceThreshold] = useState(0.3);\n\n  // Check GroundingDINO availability on component mount\n  useEffect(() => {\n    checkGroundingDinoStatus();\n  }, []);\n  const checkGroundingDinoStatus = async () => {\n    try {\n      console.log('🔍 Checking GroundingDINO status...');\n      const response = await fetch('/grounding-dino-status');\n      console.log('📡 Response status:', response.status);\n      const data = await response.json();\n      console.log('📊 Response data:', data);\n      setGroundingDinoAvailable(data.available);\n      console.log('✅ GroundingDINO available set to:', data.available);\n    } catch (error) {\n      console.error('❌ Error checking GroundingDINO status:', error);\n      setGroundingDinoAvailable(false);\n    }\n  };\n  const handleFileChange = e => {\n    const selectedFiles = Array.from(e.target.files);\n    setFiles(selectedFiles);\n\n    // Create previews for all selected files\n    const newPreviews = selectedFiles.map(file => ({\n      file,\n      url: URL.createObjectURL(file),\n      name: file.name\n    }));\n    setPreviews(newPreviews);\n    setAnnotatedResults([]); // Reset results when new files are selected\n  };\n  const handleAnnotate = async () => {\n    if (files.length === 0) {\n      alert(\"Please select at least one file first.\");\n      return;\n    }\n    setIsLoading(true);\n    setProcessingProgress({\n      current: 0,\n      total: files.length\n    });\n    setAnnotatedResults([]);\n\n    // Generate unique batch ID\n    const newBatchId = `batch_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    setBatchId(newBatchId);\n    if (annotationType === 'grounding-dino-only') {\n      await handleGroundingDinoOnlyAnnotation(newBatchId);\n    } else if (annotationType === 'grounding-dino-sam2') {\n      await handleGroundingDinoSAM2Annotation(newBatchId);\n    } else if (annotationType === 'guardrail') {\n      await handleGuardrailAnnotation(newBatchId);\n    } else {\n      await handleTraditionalAnnotation(newBatchId);\n    }\n  };\n  const handleGroundingDinoSAM2Annotation = async newBatchId => {\n    const results = [];\n    try {\n      for (let i = 0; i < files.length; i++) {\n        const file = files[i];\n        setProcessingProgress({\n          current: i + 1,\n          total: files.length\n        });\n        const formData = new FormData();\n        formData.append('file', file);\n        formData.append('prompts', groundingDinoPrompts);\n        formData.append('confidence_threshold', confidenceThreshold);\n        formData.append('batch_id', newBatchId);\n        try {\n          const response = await fetch('/grounding-dino-annotate', {\n            method: 'POST',\n            body: formData\n          });\n          if (response.ok) {\n            const result = await response.json();\n            results.push({\n              originalName: file.name,\n              success: result.status === 'success',\n              annotatedUrl: result.status === 'success' ? `data:image/jpeg;base64,${result.image_base64}` : null,\n              error: result.status !== 'success' ? result.message : null,\n              detections: result.detections || [],\n              total_detections: result.total_detections || 0,\n              yolo_annotations: result.yolo_annotations\n            });\n          } else {\n            results.push({\n              originalName: file.name,\n              success: false,\n              error: \"GroundingDINO annotation failed\"\n            });\n          }\n        } catch (error) {\n          console.error(`Error processing ${file.name}:`, error);\n          results.push({\n            originalName: file.name,\n            success: false,\n            error: \"Processing error\"\n          });\n        }\n      }\n      setAnnotatedResults(results);\n    } catch (error) {\n      console.error('GroundingDINO annotation error:', error);\n      alert('GroundingDINO annotation failed. Please try again.');\n    } finally {\n      setIsLoading(false);\n      setProcessingProgress({\n        current: 0,\n        total: 0\n      });\n    }\n  };\n  const handleGroundingDinoOnlyAnnotation = async newBatchId => {\n    const results = [];\n    try {\n      for (let i = 0; i < files.length; i++) {\n        const file = files[i];\n        setProcessingProgress({\n          current: i + 1,\n          total: files.length\n        });\n        const formData = new FormData();\n        formData.append('file', file);\n        formData.append('prompts', groundingDinoPrompts);\n        formData.append('confidence_threshold', confidenceThreshold);\n        formData.append('batch_id', newBatchId);\n        try {\n          const response = await fetch('/grounding-dino-only-annotate', {\n            method: 'POST',\n            body: formData\n          });\n          if (response.ok) {\n            const result = await response.json();\n            results.push({\n              originalName: file.name,\n              success: result.status === 'success',\n              annotatedUrl: result.status === 'success' ? `data:image/jpeg;base64,${result.image_base64}` : null,\n              error: result.status !== 'success' ? result.message : null,\n              detections: result.detections || [],\n              total_detections: result.total_detections || 0,\n              yolo_annotations: result.yolo_annotations\n            });\n          } else {\n            results.push({\n              originalName: file.name,\n              success: false,\n              error: \"GroundingDINO annotation failed\"\n            });\n          }\n        } catch (error) {\n          console.error(`Error processing ${file.name}:`, error);\n          results.push({\n            originalName: file.name,\n            success: false,\n            error: \"Processing error\"\n          });\n        }\n      }\n      setAnnotatedResults(results);\n    } catch (error) {\n      console.error('GroundingDINO annotation error:', error);\n      alert('GroundingDINO annotation failed. Please try again.');\n    } finally {\n      setIsLoading(false);\n      setProcessingProgress({\n        current: 0,\n        total: 0\n      });\n    }\n  };\n  const handleGuardrailAnnotation = async newBatchId => {\n    if (!guardrailModelFile) {\n      alert(\"Please upload your trained anomaly model file (.ckpt).\");\n      setIsLoading(false);\n      return;\n    }\n    const results = [];\n    try {\n      for (let i = 0; i < files.length; i++) {\n        const file = files[i];\n        setProcessingProgress({\n          current: i + 1,\n          total: files.length\n        });\n        const formData = new FormData();\n        formData.append(\"file\", file);\n        formData.append(\"model_file\", guardrailModelFile);\n        formData.append(\"prompts\", guardrailPrompts);\n        formData.append(\"confidence_threshold\", guardrailConfidenceThreshold);\n        try {\n          const response = await fetch('/annotate-with-guardrail', {\n            method: 'POST',\n            body: formData\n          });\n          if (response.ok) {\n            const data = await response.json();\n            results.push({\n              originalName: file.name,\n              success: data.status === 'success',\n              annotatedUrl: data.status === 'success' && data.annotated_image ? `data:image/jpeg;base64,${btoa(String.fromCharCode(...new Uint8Array(data.annotated_image)))}` : null,\n              error: data.status !== 'success' ? data.message : null,\n              detections: data.detections || [],\n              total_detections: data.detections ? data.detections.length : 0\n            });\n          } else {\n            results.push({\n              originalName: file.name,\n              success: false,\n              error: \"Guardrail annotation failed\"\n            });\n          }\n        } catch (error) {\n          console.error(`Error processing ${file.name}:`, error);\n          results.push({\n            originalName: file.name,\n            success: false,\n            error: \"Processing error\"\n          });\n        }\n      }\n      setAnnotatedResults(results);\n    } catch (error) {\n      console.error('Guardrail annotation error:', error);\n      alert('Guardrail annotation failed. Please try again.');\n    } finally {\n      setIsLoading(false);\n      setProcessingProgress({\n        current: 0,\n        total: 0\n      });\n    }\n  };\n  const handleTraditionalAnnotation = async newBatchId => {\n    const endpointMap = {\n      'detection': '/pre-annotate-detect',\n      'segmentation': '/pre-annotate-segment',\n      'sam2-detection': '/pre-annotate-sam2-detect',\n      'sam2-segmentation': '/pre-annotate-sam2-segment'\n    };\n    const endpoint = endpointMap[annotationType] || '/pre-annotate-detect';\n    const results = [];\n    try {\n      for (let i = 0; i < files.length; i++) {\n        const file = files[i];\n        setProcessingProgress({\n          current: i + 1,\n          total: files.length\n        });\n        const formData = new FormData();\n        formData.append(\"file\", file);\n        formData.append(\"batch_id\", newBatchId); // Add batch ID for caching\n\n        try {\n          const response = await fetch(endpoint, {\n            method: \"POST\",\n            body: formData\n          });\n          if (response.ok) {\n            const imageBlob = await response.blob();\n            results.push({\n              originalName: file.name,\n              annotatedUrl: URL.createObjectURL(imageBlob),\n              success: true\n            });\n          } else {\n            results.push({\n              originalName: file.name,\n              success: false,\n              error: `${annotationType} annotation failed`\n            });\n          }\n        } catch (error) {\n          console.error(`Error processing ${file.name}:`, error);\n          results.push({\n            originalName: file.name,\n            success: false,\n            error: \"Processing error\"\n          });\n        }\n      }\n      setAnnotatedResults(results);\n    } catch (error) {\n      console.error(\"Error during batch annotation:\", error);\n      alert(\"An error occurred during batch annotation.\");\n    } finally {\n      setIsLoading(false);\n      setProcessingProgress({\n        current: 0,\n        total: 0\n      });\n    }\n  };\n  const handleDownloadZip = async () => {\n    const successfulResults = annotatedResults.filter(result => result.success);\n    if (successfulResults.length === 0) {\n      alert(\"No successful annotations to download.\");\n      return;\n    }\n    try {\n      const response = await fetch(`/download-batch-zip/${batchId}`, {\n        method: 'POST'\n      });\n      if (response.ok) {\n        const blob = await response.blob();\n        const url = window.URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.style.display = 'none';\n        a.href = url;\n        a.download = `annotated_${annotationType}_batch.zip`;\n        document.body.appendChild(a);\n        a.click();\n        window.URL.revokeObjectURL(url);\n        document.body.removeChild(a);\n      } else {\n        throw new Error('Failed to download zip file');\n      }\n    } catch (error) {\n      console.error('Error downloading zip:', error);\n      alert('Failed to download zip file. Please try again.');\n    }\n  };\n  const handleExportYoloDataset = async () => {\n    const groundingDinoResults = annotatedResults.filter(result => result.success && result.yolo_annotations);\n    if (groundingDinoResults.length === 0) {\n      alert(\"No GroundingDINO results to export.\");\n      return;\n    }\n    try {\n      const formData = new FormData();\n      formData.append('annotation_results', JSON.stringify(groundingDinoResults));\n      formData.append('dataset_name', `grounding_dino_${Date.now()}`);\n      const response = await fetch('/grounding-dino-export-yolo', {\n        method: 'POST',\n        body: formData\n      });\n      if (response.ok) {\n        const data = await response.json();\n        alert(`YOLO dataset exported successfully: ${data.dataset_name}`);\n      } else {\n        throw new Error('Failed to export dataset');\n      }\n    } catch (error) {\n      console.error('Error exporting dataset:', error);\n      alert('Failed to export YOLO dataset.');\n    }\n  };\n  const renderAnnotationTypeSelector = () => /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      marginBottom: '20px'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"\\uD83C\\uDFAF Annotation Method\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        display: 'grid',\n        gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))',\n        gap: '10px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          padding: '10px',\n          border: '2px solid #e2e8f0',\n          borderRadius: '8px',\n          backgroundColor: annotationType === 'detection' ? '#dbeafe' : 'white',\n          borderColor: annotationType === 'detection' ? '#3b82f6' : '#e2e8f0',\n          cursor: 'pointer'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"radio\",\n          value: \"detection\",\n          checked: annotationType === 'detection',\n          onChange: e => setAnnotationType(e.target.value),\n          style: {\n            marginRight: '8px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 400,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\uD83D\\uDCE6 OpenCV Detection\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 407,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 390,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          padding: '10px',\n          border: '2px solid #e2e8f0',\n          borderRadius: '8px',\n          backgroundColor: annotationType === 'segmentation' ? '#dbeafe' : 'white',\n          borderColor: annotationType === 'segmentation' ? '#3b82f6' : '#e2e8f0',\n          cursor: 'pointer'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"radio\",\n          value: \"segmentation\",\n          checked: annotationType === 'segmentation',\n          onChange: e => setAnnotationType(e.target.value),\n          style: {\n            marginRight: '8px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\u2702\\uFE0F OpenCV Segmentation\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 410,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          padding: '10px',\n          border: '2px solid #e2e8f0',\n          borderRadius: '8px',\n          backgroundColor: annotationType === 'sam2-detection' ? '#dbeafe' : 'white',\n          borderColor: annotationType === 'sam2-detection' ? '#3b82f6' : '#e2e8f0',\n          cursor: 'pointer'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"radio\",\n          value: \"sam2-detection\",\n          checked: annotationType === 'sam2-detection',\n          onChange: e => setAnnotationType(e.target.value),\n          style: {\n            marginRight: '8px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\uD83C\\uDFAF SAM2 Detection\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 430,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          padding: '10px',\n          border: '2px solid #e2e8f0',\n          borderRadius: '8px',\n          backgroundColor: annotationType === 'sam2-segmentation' ? '#dbeafe' : 'white',\n          borderColor: annotationType === 'sam2-segmentation' ? '#3b82f6' : '#e2e8f0',\n          cursor: 'pointer'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"radio\",\n          value: \"sam2-segmentation\",\n          checked: annotationType === 'sam2-segmentation',\n          onChange: e => setAnnotationType(e.target.value),\n          style: {\n            marginRight: '8px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 460,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\uD83D\\uDD2A SAM2 Segmentation\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 467,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 450,\n        columnNumber: 17\n      }, this), groundingDinoAvailable && /*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          padding: '10px',\n          border: '2px solid #10b981',\n          borderRadius: '8px',\n          backgroundColor: annotationType === 'grounding-dino-only' ? '#d1fae5' : 'white',\n          borderColor: annotationType === 'grounding-dino-only' ? '#10b981' : '#10b981',\n          cursor: 'pointer'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"radio\",\n          value: \"grounding-dino-only\",\n          checked: annotationType === 'grounding-dino-only',\n          onChange: e => setAnnotationType(e.target.value),\n          style: {\n            marginRight: '8px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 481,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\u2728 GroundingDINO Only (Detection)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 488,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 471,\n        columnNumber: 21\n      }, this), groundingDinoAvailable && /*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          padding: '10px',\n          border: '2px solid #7c2d12',\n          borderRadius: '8px',\n          backgroundColor: annotationType === 'grounding-dino-sam2' ? '#fed7aa' : 'white',\n          borderColor: annotationType === 'grounding-dino-sam2' ? '#7c2d12' : '#7c2d12',\n          cursor: 'pointer'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"radio\",\n          value: \"grounding-dino-sam2\",\n          checked: annotationType === 'grounding-dino-sam2',\n          onChange: e => setAnnotationType(e.target.value),\n          style: {\n            marginRight: '8px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 503,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\uD83C\\uDFAD GroundingDINO + SAM2 (Detection + Segmentation)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 510,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 493,\n        columnNumber: 21\n      }, this), groundingDinoAvailable && /*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          padding: '10px',\n          border: '2px solid #7c3aed',\n          borderRadius: '8px',\n          backgroundColor: annotationType === 'guardrail' ? '#ede9fe' : 'white',\n          borderColor: annotationType === 'guardrail' ? '#7c3aed' : '#7c3aed',\n          cursor: 'pointer'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"radio\",\n          value: \"guardrail\",\n          checked: annotationType === 'guardrail',\n          onChange: e => setAnnotationType(e.target.value),\n          style: {\n            marginRight: '8px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 525,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\uD83D\\uDEE1\\uFE0F Guardrail (Anomaly + AI)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 532,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 515,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 389,\n      columnNumber: 13\n    }, this), !groundingDinoAvailable && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: '10px',\n        padding: '10px',\n        backgroundColor: '#fef3c7',\n        border: '1px solid #f59e0b',\n        borderRadius: '4px',\n        fontSize: '14px'\n      },\n      children: [\"\\u26A0\\uFE0F GroundingDINO not available. Please install dependencies to use AI-powered annotation.\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 547,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: checkGroundingDinoStatus,\n        style: {\n          marginTop: '5px',\n          backgroundColor: '#3b82f6',\n          color: 'white',\n          border: 'none',\n          padding: '5px 10px',\n          borderRadius: '4px',\n          cursor: 'pointer',\n          fontSize: '12px'\n        },\n        children: \"\\uD83D\\uDD04 Retry Check\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 548,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 538,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 387,\n    columnNumber: 9\n  }, this);\n  const renderGroundingDinoOptions = () => {\n    if (annotationType !== 'grounding-dino-only' && annotationType !== 'grounding-dino-sam2') return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: '20px',\n        padding: '20px',\n        backgroundColor: '#f0fdf4',\n        border: '1px solid #10b981',\n        borderRadius: '8px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        style: {\n          margin: '0 0 15px 0',\n          color: '#059669'\n        },\n        children: \"\\u2728 GroundingDINO Settings\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 579,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: '15px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: 'block',\n            marginBottom: '5px',\n            fontWeight: 'bold'\n          },\n          children: \"Defect Prompts (comma-separated):\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 582,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: groundingDinoPrompts,\n          onChange: e => setGroundingDinoPrompts(e.target.value),\n          placeholder: \"e.g., scratch, dent, dirt, corrosion, crack\",\n          style: {\n            width: '100%',\n            padding: '8px',\n            border: '1px solid #d1d5db',\n            borderRadius: '4px',\n            fontSize: '14px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 585,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '12px',\n            color: '#6b7280',\n            marginTop: '5px'\n          },\n          children: \"Describe the defects you want to detect. Be specific (e.g., \\\"scratch on metal surface\\\").\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 598,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 581,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: '15px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: 'block',\n            marginBottom: '5px',\n            fontWeight: 'bold'\n          },\n          children: [\"Confidence Threshold: \", confidenceThreshold]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 604,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"range\",\n          min: \"0.1\",\n          max: \"0.9\",\n          step: \"0.1\",\n          value: confidenceThreshold,\n          onChange: e => setConfidenceThreshold(parseFloat(e.target.value)),\n          style: {\n            width: '200px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 607,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '12px',\n            color: '#6b7280',\n            marginTop: '5px'\n          },\n          children: \"Lower values detect more objects but may include false positives.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 616,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 603,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 572,\n      columnNumber: 13\n    }, this);\n  };\n  const renderGuardrailOptions = () => {\n    if (annotationType !== 'guardrail') return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: '20px',\n        padding: '20px',\n        backgroundColor: '#faf5ff',\n        border: '1px solid #7c3aed',\n        borderRadius: '8px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        style: {\n          margin: '0 0 15px 0',\n          color: '#7c3aed'\n        },\n        children: \"\\uD83D\\uDEE1\\uFE0F Guardrail Settings (Anomaly Detection + AI Classification)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 635,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: '15px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: 'block',\n            marginBottom: '5px',\n            fontWeight: 'bold'\n          },\n          children: \"Upload Anomaly Model File:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 639,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          accept: \".ckpt,.pth,.pt\",\n          onChange: e => setGuardrailModelFile(e.target.files[0]),\n          style: {\n            width: '100%',\n            padding: '8px',\n            border: '1px solid #d1d5db',\n            borderRadius: '4px',\n            fontSize: '14px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 642,\n          columnNumber: 21\n        }, this), guardrailModelFile && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '12px',\n            color: '#059669',\n            marginTop: '5px'\n          },\n          children: [\"\\u2705 Selected: \", guardrailModelFile.name]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 655,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '12px',\n            color: '#6b7280',\n            marginTop: '5px'\n          },\n          children: [\"Upload your trained PatchCore anomaly detection model (.ckpt file).\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 661,\n            columnNumber: 25\n          }, this), \"\\uD83D\\uDCA1 Train one in the \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Train\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 661,\n            columnNumber: 51\n          }, this), \" page first!\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 659,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 638,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: '15px',\n          padding: '10px',\n          backgroundColor: '#e0e7ff',\n          border: '1px solid #6366f1',\n          borderRadius: '6px'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '14px',\n            color: '#4f46e5'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"\\uD83D\\uDCDA Need to train an anomaly model?\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 674,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 675,\n            columnNumber: 25\n          }, this), \"Go to the \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Train\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 675,\n            columnNumber: 41\n          }, this), \" page to create a new anomaly detection model using defect-free images.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 673,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 666,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: '15px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: 'block',\n            marginBottom: '5px',\n            fontWeight: 'bold'\n          },\n          children: \"Classification Prompts (comma-separated):\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 681,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: guardrailPrompts,\n          onChange: e => setGuardrailPrompts(e.target.value),\n          placeholder: \"e.g., scratch, dent, dirt, corrosion, crack\",\n          style: {\n            width: '100%',\n            padding: '8px',\n            border: '1px solid #d1d5db',\n            borderRadius: '4px',\n            fontSize: '14px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 684,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '12px',\n            color: '#6b7280',\n            marginTop: '5px'\n          },\n          children: \"After detecting anomalies, the system will use GroundingDINO to classify them with these prompts.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 697,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 680,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: '15px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: 'block',\n            marginBottom: '5px',\n            fontWeight: 'bold'\n          },\n          children: [\"Classification Confidence Threshold: \", guardrailConfidenceThreshold]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 704,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"range\",\n          min: \"0.1\",\n          max: \"0.9\",\n          step: \"0.1\",\n          value: guardrailConfidenceThreshold,\n          onChange: e => setGuardrailConfidenceThreshold(parseFloat(e.target.value)),\n          style: {\n            width: '200px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 707,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontSize: '12px',\n            color: '#6b7280',\n            marginTop: '5px'\n          },\n          children: \"Confidence threshold for GroundingDINO classification of detected anomalies.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 716,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 703,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: '10px',\n          backgroundColor: '#e0e7ff',\n          border: '1px solid #3b82f6',\n          borderRadius: '4px',\n          fontSize: '12px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"How Guardrail Works:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 729,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"ol\", {\n          style: {\n            margin: '5px 0',\n            paddingLeft: '20px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"li\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Anomaly Detection:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 731,\n              columnNumber: 29\n            }, this), \" PatchCore detects deviations from \\\"normal\\\" (high sensitivity)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 731,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Classification:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 732,\n              columnNumber: 29\n            }, this), \" GroundingDINO classifies detected anomalies using your prompts\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 732,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n              children: \"Result:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 733,\n              columnNumber: 29\n            }, this), \" Only real defects are labeled, with minimal false positives\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 733,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 730,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 722,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 628,\n      columnNumber: 13\n    }, this);\n  };\n  const renderResults = () => {\n    if (annotatedResults.length === 0) return null;\n    const successfulResults = annotatedResults.filter(result => result.success);\n    const failedResults = annotatedResults.filter(result => !result.success);\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: '30px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          marginBottom: '20px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"\\uD83D\\uDCCA Annotation Results\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 749,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            gap: '10px'\n          },\n          children: [successfulResults.length > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleDownloadZip,\n            style: {\n              backgroundColor: '#059669',\n              color: 'white',\n              padding: '8px 16px',\n              border: 'none',\n              borderRadius: '4px',\n              cursor: 'pointer'\n            },\n            children: \"\\uD83D\\uDCE5 Download ZIP\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 752,\n            columnNumber: 29\n          }, this), annotationType === 'grounding-dino' && successfulResults.some(r => r.yolo_annotations) && /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleExportYoloDataset,\n            style: {\n              backgroundColor: '#7c3aed',\n              color: 'white',\n              padding: '8px 16px',\n              border: 'none',\n              borderRadius: '4px',\n              cursor: 'pointer'\n            },\n            children: \"\\uD83D\\uDCE6 Export YOLO Dataset\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 767,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 750,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 748,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'grid',\n          gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))',\n          gap: '20px',\n          marginBottom: '20px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: '15px',\n            backgroundColor: '#dcfce7',\n            border: '1px solid #86efac',\n            borderRadius: '8px'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '18px',\n              fontWeight: 'bold',\n              color: '#059669'\n            },\n            children: [\"\\u2705 Successful: \", successfulResults.length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 796,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 790,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: '15px',\n            backgroundColor: '#fee2e2',\n            border: '1px solid #fca5a5',\n            borderRadius: '8px'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '18px',\n              fontWeight: 'bold',\n              color: '#dc2626'\n            },\n            children: [\"\\u274C Failed: \", failedResults.length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 806,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 800,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 784,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'grid',\n          gridTemplateColumns: 'repeat(auto-fit, minmax(400px, 1fr))',\n          gap: '20px'\n        },\n        children: annotatedResults.map((result, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            border: '1px solid #e2e8f0',\n            borderRadius: '8px',\n            padding: '15px',\n            backgroundColor: result.success ? '#f9fafb' : '#fef2f2'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            style: {\n              margin: '0 0 10px 0'\n            },\n            children: result.originalName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 820,\n            columnNumber: 29\n          }, this), result.success ? /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"img\", {\n              src: result.annotatedUrl,\n              alt: `Annotated ${result.originalName}`,\n              style: {\n                width: '100%',\n                borderRadius: '4px',\n                marginBottom: '10px'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 824,\n              columnNumber: 37\n            }, this), result.detections && /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '14px',\n                color: '#6b7280'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Detections:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 832,\n                columnNumber: 45\n              }, this), \" \", result.total_detections || result.detections.length, result.detections.map((detection, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n                style: {\n                  marginLeft: '10px',\n                  fontSize: '12px'\n                },\n                children: [\"\\u2022 \", detection.class, \": \", (detection.confidence * 100).toFixed(1), \"%\"]\n              }, idx, true, {\n                fileName: _jsxFileName,\n                lineNumber: 834,\n                columnNumber: 49\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 831,\n              columnNumber: 41\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 823,\n            columnNumber: 33\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              color: '#dc2626'\n            },\n            children: [\"Error: \", result.error]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 842,\n            columnNumber: 33\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 814,\n          columnNumber: 25\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 812,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 747,\n      columnNumber: 13\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: '20px',\n      maxWidth: '1200px',\n      margin: '0 auto'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"\\uD83C\\uDFF7\\uFE0F Image Annotation\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 855,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: '20px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        style: {\n          display: 'block',\n          marginBottom: '10px',\n          fontSize: '16px',\n          fontWeight: 'bold'\n        },\n        children: \"\\uD83D\\uDCC1 Select Images:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 858,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        multiple: true,\n        accept: \"image/*\",\n        onChange: handleFileChange,\n        style: {\n          padding: '10px',\n          border: '2px dashed #d1d5db',\n          borderRadius: '8px',\n          width: '100%',\n          cursor: 'pointer'\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 861,\n        columnNumber: 17\n      }, this), files.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '10px',\n          fontSize: '14px',\n          color: '#059669'\n        },\n        children: [\"\\u2705 \", files.length, \" image(s) selected\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 875,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 857,\n      columnNumber: 13\n    }, this), renderAnnotationTypeSelector(), renderGroundingDinoOptions(), renderGuardrailOptions(), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginBottom: '30px'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleAnnotate,\n        disabled: files.length === 0 || isLoading,\n        style: {\n          backgroundColor: files.length === 0 || isLoading ? '#9ca3af' : '#1e3a8a',\n          color: 'white',\n          padding: '12px 24px',\n          border: 'none',\n          borderRadius: '8px',\n          fontSize: '16px',\n          cursor: files.length === 0 || isLoading ? 'not-allowed' : 'pointer'\n        },\n        children: isLoading ? `🔄 Processing... (${processingProgress.current}/${processingProgress.total})` : '🚀 Start Annotation'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 886,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 885,\n      columnNumber: 13\n    }, this), renderResults()]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 854,\n    columnNumber: 9\n  }, this);\n}\nexport default Annotate;","map":{"version":3,"names":["React","useState","useEffect","jsxDEV","_jsxDEV","Annotate","files","setFiles","previews","setPreviews","annotatedResults","setAnnotatedResults","annotationType","setAnnotationType","isLoading","setIsLoading","processingProgress","setProcessingProgress","current","total","batchId","setBatchId","groundingDinoPrompts","setGroundingDinoPrompts","confidenceThreshold","setConfidenceThreshold","groundingDinoAvailable","setGroundingDinoAvailable","guardrailModelFile","setGuardrailModelFile","guardrailPrompts","setGuardrailPrompts","guardrailConfidenceThreshold","setGuardrailConfidenceThreshold","checkGroundingDinoStatus","console","log","response","fetch","status","data","json","available","error","handleFileChange","e","selectedFiles","Array","from","target","newPreviews","map","file","url","URL","createObjectURL","name","handleAnnotate","length","alert","newBatchId","Date","now","Math","random","toString","substr","handleGroundingDinoOnlyAnnotation","handleGroundingDinoSAM2Annotation","handleGuardrailAnnotation","handleTraditionalAnnotation","results","i","formData","FormData","append","method","body","ok","result","push","originalName","success","annotatedUrl","image_base64","message","detections","total_detections","yolo_annotations","annotated_image","btoa","String","fromCharCode","Uint8Array","endpointMap","endpoint","imageBlob","blob","handleDownloadZip","successfulResults","filter","window","a","document","createElement","style","display","href","download","appendChild","click","revokeObjectURL","removeChild","Error","handleExportYoloDataset","groundingDinoResults","JSON","stringify","dataset_name","renderAnnotationTypeSelector","marginBottom","children","fileName","_jsxFileName","lineNumber","columnNumber","gridTemplateColumns","gap","alignItems","padding","border","borderRadius","backgroundColor","borderColor","cursor","type","value","checked","onChange","marginRight","marginTop","fontSize","onClick","color","renderGroundingDinoOptions","margin","fontWeight","placeholder","width","min","max","step","parseFloat","renderGuardrailOptions","accept","paddingLeft","renderResults","failedResults","justifyContent","some","r","index","src","alt","detection","idx","marginLeft","class","confidence","toFixed","maxWidth","multiple","disabled"],"sources":["/Users/truonghaidang/Desktop/open-trainer/frontend/src/components/Annotate.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\n\nfunction Annotate() {\n    const [files, setFiles] = useState([]);\n    const [previews, setPreviews] = useState([]);\n    const [annotatedResults, setAnnotatedResults] = useState([]);\n    const [annotationType, setAnnotationType] = useState('detection');\n    const [isLoading, setIsLoading] = useState(false);\n    const [processingProgress, setProcessingProgress] = useState({ current: 0, total: 0 });\n    const [batchId, setBatchId] = useState(null);\n    \n    // GroundingDINO specific state\n    const [groundingDinoPrompts, setGroundingDinoPrompts] = useState('scratch, dent, dirt');\n    const [confidenceThreshold, setConfidenceThreshold] = useState(0.3);\n    const [groundingDinoAvailable, setGroundingDinoAvailable] = useState(false);\n\n    // Guardrail (Anomaly Detection + Classification) specific state\n    const [guardrailModelFile, setGuardrailModelFile] = useState(null);\n    const [guardrailPrompts, setGuardrailPrompts] = useState('scratch, dent, dirt');\n    const [guardrailConfidenceThreshold, setGuardrailConfidenceThreshold] = useState(0.3);\n\n    // Check GroundingDINO availability on component mount\n    useEffect(() => {\n        checkGroundingDinoStatus();\n    }, []);\n\n    const checkGroundingDinoStatus = async () => {\n        try {\n            console.log('🔍 Checking GroundingDINO status...');\n            const response = await fetch('/grounding-dino-status');\n            console.log('📡 Response status:', response.status);\n            const data = await response.json();\n            console.log('📊 Response data:', data);\n            setGroundingDinoAvailable(data.available);\n            console.log('✅ GroundingDINO available set to:', data.available);\n        } catch (error) {\n            console.error('❌ Error checking GroundingDINO status:', error);\n            setGroundingDinoAvailable(false);\n        }\n    };\n\n    const handleFileChange = (e) => {\n        const selectedFiles = Array.from(e.target.files);\n        setFiles(selectedFiles);\n        \n        // Create previews for all selected files\n        const newPreviews = selectedFiles.map(file => ({\n            file,\n            url: URL.createObjectURL(file),\n            name: file.name\n        }));\n        setPreviews(newPreviews);\n        setAnnotatedResults([]); // Reset results when new files are selected\n    };\n\n    const handleAnnotate = async () => {\n        if (files.length === 0) {\n            alert(\"Please select at least one file first.\");\n            return;\n        }\n\n        setIsLoading(true);\n        setProcessingProgress({ current: 0, total: files.length });\n        setAnnotatedResults([]);\n\n        // Generate unique batch ID\n        const newBatchId = `batch_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n        setBatchId(newBatchId);\n\n        if (annotationType === 'grounding-dino-only') {\n            await handleGroundingDinoOnlyAnnotation(newBatchId);\n        } else if (annotationType === 'grounding-dino-sam2') {\n            await handleGroundingDinoSAM2Annotation(newBatchId);\n        } else if (annotationType === 'guardrail') {\n            await handleGuardrailAnnotation(newBatchId);\n        } else {\n            await handleTraditionalAnnotation(newBatchId);\n        }\n    };\n\n    const handleGroundingDinoSAM2Annotation = async (newBatchId) => {\n        const results = [];\n        \n        try {\n            for (let i = 0; i < files.length; i++) {\n                const file = files[i];\n                setProcessingProgress({ current: i + 1, total: files.length });\n\n                const formData = new FormData();\n                formData.append('file', file);\n                formData.append('prompts', groundingDinoPrompts);\n                formData.append('confidence_threshold', confidenceThreshold);\n                formData.append('batch_id', newBatchId);\n\n                try {\n                    const response = await fetch('/grounding-dino-annotate', {\n                        method: 'POST',\n                        body: formData\n                    });\n\n                    if (response.ok) {\n                        const result = await response.json();\n                        results.push({\n                            originalName: file.name,\n                            success: result.status === 'success',\n                            annotatedUrl: result.status === 'success' ? `data:image/jpeg;base64,${result.image_base64}` : null,\n                            error: result.status !== 'success' ? result.message : null,\n                            detections: result.detections || [],\n                            total_detections: result.total_detections || 0,\n                            yolo_annotations: result.yolo_annotations\n                        });\n                    } else {\n                        results.push({\n                            originalName: file.name,\n                            success: false,\n                            error: \"GroundingDINO annotation failed\"\n                        });\n                    }\n                } catch (error) {\n                    console.error(`Error processing ${file.name}:`, error);\n                    results.push({\n                        originalName: file.name,\n                        success: false,\n                        error: \"Processing error\"\n                    });\n                }\n            }\n\n            setAnnotatedResults(results);\n        } catch (error) {\n            console.error('GroundingDINO annotation error:', error);\n            alert('GroundingDINO annotation failed. Please try again.');\n        } finally {\n            setIsLoading(false);\n            setProcessingProgress({ current: 0, total: 0 });\n        }\n    };\n\n    const handleGroundingDinoOnlyAnnotation = async (newBatchId) => {\n        const results = [];\n        \n        try {\n            for (let i = 0; i < files.length; i++) {\n                const file = files[i];\n                setProcessingProgress({ current: i + 1, total: files.length });\n\n                const formData = new FormData();\n                formData.append('file', file);\n                formData.append('prompts', groundingDinoPrompts);\n                formData.append('confidence_threshold', confidenceThreshold);\n                formData.append('batch_id', newBatchId);\n\n                try {\n                    const response = await fetch('/grounding-dino-only-annotate', {\n                        method: 'POST',\n                        body: formData\n                    });\n\n                    if (response.ok) {\n                        const result = await response.json();\n                        results.push({\n                            originalName: file.name,\n                            success: result.status === 'success',\n                            annotatedUrl: result.status === 'success' ? `data:image/jpeg;base64,${result.image_base64}` : null,\n                            error: result.status !== 'success' ? result.message : null,\n                            detections: result.detections || [],\n                            total_detections: result.total_detections || 0,\n                            yolo_annotations: result.yolo_annotations\n                        });\n                    } else {\n                        results.push({\n                            originalName: file.name,\n                            success: false,\n                            error: \"GroundingDINO annotation failed\"\n                        });\n                    }\n                } catch (error) {\n                    console.error(`Error processing ${file.name}:`, error);\n                    results.push({\n                        originalName: file.name,\n                        success: false,\n                        error: \"Processing error\"\n                    });\n                }\n            }\n\n            setAnnotatedResults(results);\n        } catch (error) {\n            console.error('GroundingDINO annotation error:', error);\n            alert('GroundingDINO annotation failed. Please try again.');\n        } finally {\n            setIsLoading(false);\n            setProcessingProgress({ current: 0, total: 0 });\n        }\n    };\n\n    const handleGuardrailAnnotation = async (newBatchId) => {\n        if (!guardrailModelFile) {\n            alert(\"Please upload your trained anomaly model file (.ckpt).\");\n            setIsLoading(false);\n            return;\n        }\n\n        const results = [];\n\n        try {\n            for (let i = 0; i < files.length; i++) {\n                const file = files[i];\n                setProcessingProgress({ current: i + 1, total: files.length });\n\n                const formData = new FormData();\n                formData.append(\"file\", file);\n                formData.append(\"model_file\", guardrailModelFile);\n                formData.append(\"prompts\", guardrailPrompts);\n                formData.append(\"confidence_threshold\", guardrailConfidenceThreshold);\n\n                try {\n                    const response = await fetch('/annotate-with-guardrail', {\n                        method: 'POST',\n                        body: formData\n                    });\n\n                    if (response.ok) {\n                        const data = await response.json();\n                        results.push({\n                            originalName: file.name,\n                            success: data.status === 'success',\n                            annotatedUrl: data.status === 'success' && data.annotated_image ? \n                                `data:image/jpeg;base64,${btoa(String.fromCharCode(...new Uint8Array(data.annotated_image)))}` : null,\n                            error: data.status !== 'success' ? data.message : null,\n                            detections: data.detections || [],\n                            total_detections: data.detections ? data.detections.length : 0\n                        });\n                    } else {\n                        results.push({\n                            originalName: file.name,\n                            success: false,\n                            error: \"Guardrail annotation failed\"\n                        });\n                    }\n                } catch (error) {\n                    console.error(`Error processing ${file.name}:`, error);\n                    results.push({\n                        originalName: file.name,\n                        success: false,\n                        error: \"Processing error\"\n                    });\n                }\n            }\n\n            setAnnotatedResults(results);\n        } catch (error) {\n            console.error('Guardrail annotation error:', error);\n            alert('Guardrail annotation failed. Please try again.');\n        } finally {\n            setIsLoading(false);\n            setProcessingProgress({ current: 0, total: 0 });\n        }\n    };\n\n    const handleTraditionalAnnotation = async (newBatchId) => {\n        const endpointMap = {\n            'detection': '/pre-annotate-detect',\n            'segmentation': '/pre-annotate-segment',\n            'sam2-detection': '/pre-annotate-sam2-detect',\n            'sam2-segmentation': '/pre-annotate-sam2-segment'\n        };\n        const endpoint = endpointMap[annotationType] || '/pre-annotate-detect';\n\n        const results = [];\n\n        try {\n            for (let i = 0; i < files.length; i++) {\n                const file = files[i];\n                setProcessingProgress({ current: i + 1, total: files.length });\n\n                const formData = new FormData();\n                formData.append(\"file\", file);\n                formData.append(\"batch_id\", newBatchId); // Add batch ID for caching\n\n                try {\n                    const response = await fetch(endpoint, {\n                        method: \"POST\",\n                        body: formData,\n                    });\n\n                    if (response.ok) {\n                        const imageBlob = await response.blob();\n                        results.push({\n                            originalName: file.name,\n                            annotatedUrl: URL.createObjectURL(imageBlob),\n                            success: true\n                        });\n                    } else {\n                        results.push({\n                            originalName: file.name,\n                            success: false,\n                            error: `${annotationType} annotation failed`\n                        });\n                    }\n                } catch (error) {\n                    console.error(`Error processing ${file.name}:`, error);\n                    results.push({\n                        originalName: file.name,\n                        success: false,\n                        error: \"Processing error\"\n                    });\n                }\n            }\n\n            setAnnotatedResults(results);\n        } catch (error) {\n            console.error(\"Error during batch annotation:\", error);\n            alert(\"An error occurred during batch annotation.\");\n        } finally {\n            setIsLoading(false);\n            setProcessingProgress({ current: 0, total: 0 });\n        }\n    };\n\n    const handleDownloadZip = async () => {\n        const successfulResults = annotatedResults.filter(result => result.success);\n        \n        if (successfulResults.length === 0) {\n            alert(\"No successful annotations to download.\");\n            return;\n        }\n\n        try {\n            const response = await fetch(`/download-batch-zip/${batchId}`, {\n                method: 'POST',\n            });\n\n            if (response.ok) {\n                const blob = await response.blob();\n                const url = window.URL.createObjectURL(blob);\n                const a = document.createElement('a');\n                a.style.display = 'none';\n                a.href = url;\n                a.download = `annotated_${annotationType}_batch.zip`;\n                document.body.appendChild(a);\n                a.click();\n                window.URL.revokeObjectURL(url);\n                document.body.removeChild(a);\n            } else {\n                throw new Error('Failed to download zip file');\n            }\n        } catch (error) {\n            console.error('Error downloading zip:', error);\n            alert('Failed to download zip file. Please try again.');\n        }\n    };\n\n    const handleExportYoloDataset = async () => {\n        const groundingDinoResults = annotatedResults.filter(result => \n            result.success && result.yolo_annotations\n        );\n\n        if (groundingDinoResults.length === 0) {\n            alert(\"No GroundingDINO results to export.\");\n            return;\n        }\n\n        try {\n            const formData = new FormData();\n            formData.append('annotation_results', JSON.stringify(groundingDinoResults));\n            formData.append('dataset_name', `grounding_dino_${Date.now()}`);\n\n            const response = await fetch('/grounding-dino-export-yolo', {\n                method: 'POST',\n                body: formData\n            });\n\n            if (response.ok) {\n                const data = await response.json();\n                alert(`YOLO dataset exported successfully: ${data.dataset_name}`);\n            } else {\n                throw new Error('Failed to export dataset');\n            }\n        } catch (error) {\n            console.error('Error exporting dataset:', error);\n            alert('Failed to export YOLO dataset.');\n        }\n    };\n\n    const renderAnnotationTypeSelector = () => (\n        <div style={{ marginBottom: '20px' }}>\n            <h3>🎯 Annotation Method</h3>\n            <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', gap: '10px' }}>\n                <label style={{ \n                    display: 'flex', \n                    alignItems: 'center',\n                    padding: '10px',\n                    border: '2px solid #e2e8f0',\n                    borderRadius: '8px',\n                    backgroundColor: annotationType === 'detection' ? '#dbeafe' : 'white',\n                    borderColor: annotationType === 'detection' ? '#3b82f6' : '#e2e8f0',\n                    cursor: 'pointer'\n                }}>\n                    <input\n                        type=\"radio\"\n                        value=\"detection\"\n                        checked={annotationType === 'detection'}\n                        onChange={(e) => setAnnotationType(e.target.value)}\n                        style={{ marginRight: '8px' }}\n                    />\n                    <span>📦 OpenCV Detection</span>\n                </label>\n\n                <label style={{\n                    display: 'flex', \n                    alignItems: 'center',\n                    padding: '10px',\n                    border: '2px solid #e2e8f0',\n                    borderRadius: '8px',\n                    backgroundColor: annotationType === 'segmentation' ? '#dbeafe' : 'white',\n                    borderColor: annotationType === 'segmentation' ? '#3b82f6' : '#e2e8f0',\n                    cursor: 'pointer'\n                }}>\n                    <input\n                        type=\"radio\"\n                        value=\"segmentation\"\n                        checked={annotationType === 'segmentation'}\n                        onChange={(e) => setAnnotationType(e.target.value)}\n                        style={{ marginRight: '8px' }}\n                    />\n                    <span>✂️ OpenCV Segmentation</span>\n                </label>\n\n                <label style={{\n                    display: 'flex', \n                    alignItems: 'center',\n                    padding: '10px',\n                    border: '2px solid #e2e8f0',\n                    borderRadius: '8px',\n                    backgroundColor: annotationType === 'sam2-detection' ? '#dbeafe' : 'white',\n                    borderColor: annotationType === 'sam2-detection' ? '#3b82f6' : '#e2e8f0',\n                    cursor: 'pointer'\n                }}>\n                    <input\n                        type=\"radio\"\n                        value=\"sam2-detection\"\n                        checked={annotationType === 'sam2-detection'}\n                        onChange={(e) => setAnnotationType(e.target.value)}\n                        style={{ marginRight: '8px' }}\n                    />\n                    <span>🎯 SAM2 Detection</span>\n                </label>\n\n                <label style={{\n                    display: 'flex', \n                    alignItems: 'center',\n                    padding: '10px',\n                    border: '2px solid #e2e8f0',\n                    borderRadius: '8px',\n                    backgroundColor: annotationType === 'sam2-segmentation' ? '#dbeafe' : 'white',\n                    borderColor: annotationType === 'sam2-segmentation' ? '#3b82f6' : '#e2e8f0',\n                    cursor: 'pointer'\n                }}>\n                    <input\n                        type=\"radio\"\n                        value=\"sam2-segmentation\"\n                        checked={annotationType === 'sam2-segmentation'}\n                        onChange={(e) => setAnnotationType(e.target.value)}\n                        style={{ marginRight: '8px' }}\n                    />\n                    <span>🔪 SAM2 Segmentation</span>\n                </label>\n\n                {groundingDinoAvailable && (\n                    <label style={{\n                        display: 'flex', \n                        alignItems: 'center',\n                        padding: '10px',\n                        border: '2px solid #10b981',\n                        borderRadius: '8px',\n                        backgroundColor: annotationType === 'grounding-dino-only' ? '#d1fae5' : 'white',\n                        borderColor: annotationType === 'grounding-dino-only' ? '#10b981' : '#10b981',\n                        cursor: 'pointer'\n                    }}>\n                        <input\n                            type=\"radio\"\n                            value=\"grounding-dino-only\"\n                            checked={annotationType === 'grounding-dino-only'}\n                            onChange={(e) => setAnnotationType(e.target.value)}\n                            style={{ marginRight: '8px' }}\n                        />\n                        <span>✨ GroundingDINO Only (Detection)</span>\n                    </label>\n                )}\n\n                {groundingDinoAvailable && (\n                    <label style={{\n                        display: 'flex', \n                        alignItems: 'center',\n                        padding: '10px',\n                        border: '2px solid #7c2d12',\n                        borderRadius: '8px',\n                        backgroundColor: annotationType === 'grounding-dino-sam2' ? '#fed7aa' : 'white',\n                        borderColor: annotationType === 'grounding-dino-sam2' ? '#7c2d12' : '#7c2d12',\n                        cursor: 'pointer'\n                    }}>\n                        <input\n                            type=\"radio\"\n                            value=\"grounding-dino-sam2\"\n                            checked={annotationType === 'grounding-dino-sam2'}\n                            onChange={(e) => setAnnotationType(e.target.value)}\n                            style={{ marginRight: '8px' }}\n                        />\n                        <span>🎭 GroundingDINO + SAM2 (Detection + Segmentation)</span>\n                    </label>\n                )}\n\n                {groundingDinoAvailable && (\n                    <label style={{\n                        display: 'flex', \n                        alignItems: 'center',\n                        padding: '10px',\n                        border: '2px solid #7c3aed',\n                        borderRadius: '8px',\n                        backgroundColor: annotationType === 'guardrail' ? '#ede9fe' : 'white',\n                        borderColor: annotationType === 'guardrail' ? '#7c3aed' : '#7c3aed',\n                        cursor: 'pointer'\n                    }}>\n                        <input\n                            type=\"radio\"\n                            value=\"guardrail\"\n                            checked={annotationType === 'guardrail'}\n                            onChange={(e) => setAnnotationType(e.target.value)}\n                            style={{ marginRight: '8px' }}\n                        />\n                        <span>🛡️ Guardrail (Anomaly + AI)</span>\n                    </label>\n                )}\n            </div>\n\n            {!groundingDinoAvailable && (\n                <div style={{ \n                    marginTop: '10px', \n                    padding: '10px', \n                    backgroundColor: '#fef3c7', \n                    border: '1px solid #f59e0b',\n                    borderRadius: '4px',\n                    fontSize: '14px'\n                }}>\n                    ⚠️ GroundingDINO not available. Please install dependencies to use AI-powered annotation.\n                    <br />\n                    <button \n                        onClick={checkGroundingDinoStatus}\n                        style={{\n                            marginTop: '5px',\n                            backgroundColor: '#3b82f6',\n                            color: 'white',\n                            border: 'none',\n                            padding: '5px 10px',\n                            borderRadius: '4px',\n                            cursor: 'pointer',\n                            fontSize: '12px'\n                        }}\n                    >\n                        🔄 Retry Check\n                    </button>\n                </div>\n            )}\n        </div>\n    );\n\n    const renderGroundingDinoOptions = () => {\n        if (annotationType !== 'grounding-dino-only' && annotationType !== 'grounding-dino-sam2') return null;\n\n        return (\n            <div style={{\n                marginBottom: '20px',\n                padding: '20px',\n                backgroundColor: '#f0fdf4',\n                border: '1px solid #10b981',\n                borderRadius: '8px'\n            }}>\n                <h4 style={{ margin: '0 0 15px 0', color: '#059669' }}>✨ GroundingDINO Settings</h4>\n                \n                <div style={{ marginBottom: '15px' }}>\n                    <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\n                        Defect Prompts (comma-separated):\n                    </label>\n                    <input\n                        type=\"text\"\n                        value={groundingDinoPrompts}\n                        onChange={(e) => setGroundingDinoPrompts(e.target.value)}\n                        placeholder=\"e.g., scratch, dent, dirt, corrosion, crack\"\n                        style={{ \n                            width: '100%', \n                            padding: '8px', \n                            border: '1px solid #d1d5db',\n                            borderRadius: '4px',\n                            fontSize: '14px'\n                        }}\n                    />\n                    <div style={{ fontSize: '12px', color: '#6b7280', marginTop: '5px' }}>\n                        Describe the defects you want to detect. Be specific (e.g., \"scratch on metal surface\").\n                    </div>\n                </div>\n\n                <div style={{ marginBottom: '15px' }}>\n                    <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\n                        Confidence Threshold: {confidenceThreshold}\n                    </label>\n                    <input\n                        type=\"range\"\n                        min=\"0.1\"\n                        max=\"0.9\"\n                        step=\"0.1\"\n                        value={confidenceThreshold}\n                        onChange={(e) => setConfidenceThreshold(parseFloat(e.target.value))}\n                        style={{ width: '200px' }}\n                    />\n                    <div style={{ fontSize: '12px', color: '#6b7280', marginTop: '5px' }}>\n                        Lower values detect more objects but may include false positives.\n                    </div>\n                </div>\n            </div>\n        );\n    };\n\n    const renderGuardrailOptions = () => {\n        if (annotationType !== 'guardrail') return null;\n\n        return (\n            <div style={{\n                marginBottom: '20px',\n                padding: '20px',\n                backgroundColor: '#faf5ff',\n                border: '1px solid #7c3aed',\n                borderRadius: '8px'\n            }}>\n                <h4 style={{ margin: '0 0 15px 0', color: '#7c3aed' }}>🛡️ Guardrail Settings (Anomaly Detection + AI Classification)</h4>\n                \n                {/* Model File Upload */}\n                <div style={{ marginBottom: '15px' }}>\n                    <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\n                        Upload Anomaly Model File:\n                    </label>\n                    <input\n                        type=\"file\"\n                        accept=\".ckpt,.pth,.pt\"\n                        onChange={(e) => setGuardrailModelFile(e.target.files[0])}\n                        style={{ \n                            width: '100%', \n                            padding: '8px', \n                            border: '1px solid #d1d5db',\n                            borderRadius: '4px',\n                            fontSize: '14px'\n                        }}\n                    />\n                    {guardrailModelFile && (\n                        <div style={{ fontSize: '12px', color: '#059669', marginTop: '5px' }}>\n                            ✅ Selected: {guardrailModelFile.name}\n                        </div>\n                    )}\n                    <div style={{ fontSize: '12px', color: '#6b7280', marginTop: '5px' }}>\n                        Upload your trained PatchCore anomaly detection model (.ckpt file). \n                        <br />💡 Train one in the <strong>Train</strong> page first!\n                    </div>\n                </div>\n\n                {/* Training Link */}\n                <div style={{ \n                    marginBottom: '15px',\n                    padding: '10px',\n                    backgroundColor: '#e0e7ff',\n                    border: '1px solid #6366f1',\n                    borderRadius: '6px'\n                }}>\n                    <div style={{ fontSize: '14px', color: '#4f46e5' }}>\n                        <strong>📚 Need to train an anomaly model?</strong>\n                        <br />Go to the <strong>Train</strong> page to create a new anomaly detection model using defect-free images.\n                    </div>\n                </div>\n\n                {/* Classification Prompts */}\n                <div style={{ marginBottom: '15px' }}>\n                    <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\n                        Classification Prompts (comma-separated):\n                    </label>\n                    <input\n                        type=\"text\"\n                        value={guardrailPrompts}\n                        onChange={(e) => setGuardrailPrompts(e.target.value)}\n                        placeholder=\"e.g., scratch, dent, dirt, corrosion, crack\"\n                        style={{ \n                            width: '100%', \n                            padding: '8px', \n                            border: '1px solid #d1d5db',\n                            borderRadius: '4px',\n                            fontSize: '14px'\n                        }}\n                    />\n                    <div style={{ fontSize: '12px', color: '#6b7280', marginTop: '5px' }}>\n                        After detecting anomalies, the system will use GroundingDINO to classify them with these prompts.\n                    </div>\n                </div>\n\n                {/* Confidence Threshold */}\n                <div style={{ marginBottom: '15px' }}>\n                    <label style={{ display: 'block', marginBottom: '5px', fontWeight: 'bold' }}>\n                        Classification Confidence Threshold: {guardrailConfidenceThreshold}\n                    </label>\n                    <input\n                        type=\"range\"\n                        min=\"0.1\"\n                        max=\"0.9\"\n                        step=\"0.1\"\n                        value={guardrailConfidenceThreshold}\n                        onChange={(e) => setGuardrailConfidenceThreshold(parseFloat(e.target.value))}\n                        style={{ width: '200px' }}\n                    />\n                    <div style={{ fontSize: '12px', color: '#6b7280', marginTop: '5px' }}>\n                        Confidence threshold for GroundingDINO classification of detected anomalies.\n                    </div>\n                </div>\n\n                {/* How it works */}\n                <div style={{\n                    padding: '10px',\n                    backgroundColor: '#e0e7ff',\n                    border: '1px solid #3b82f6',\n                    borderRadius: '4px',\n                    fontSize: '12px'\n                }}>\n                    <strong>How Guardrail Works:</strong>\n                    <ol style={{ margin: '5px 0', paddingLeft: '20px' }}>\n                        <li><strong>Anomaly Detection:</strong> PatchCore detects deviations from \"normal\" (high sensitivity)</li>\n                        <li><strong>Classification:</strong> GroundingDINO classifies detected anomalies using your prompts</li>\n                        <li><strong>Result:</strong> Only real defects are labeled, with minimal false positives</li>\n                    </ol>\n                </div>\n            </div>\n        );\n    };\n\n    const renderResults = () => {\n        if (annotatedResults.length === 0) return null;\n\n        const successfulResults = annotatedResults.filter(result => result.success);\n        const failedResults = annotatedResults.filter(result => !result.success);\n\n        return (\n            <div style={{ marginTop: '30px' }}>\n                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>\n                    <h3>📊 Annotation Results</h3>\n                    <div style={{ display: 'flex', gap: '10px' }}>\n                        {successfulResults.length > 0 && (\n                            <button \n                                onClick={handleDownloadZip}\n                                style={{\n                                    backgroundColor: '#059669',\n                                    color: 'white',\n                                    padding: '8px 16px',\n                                    border: 'none',\n                                    borderRadius: '4px',\n                                    cursor: 'pointer'\n                                }}\n                            >\n                                📥 Download ZIP\n                            </button>\n                        )}\n                        {annotationType === 'grounding-dino' && successfulResults.some(r => r.yolo_annotations) && (\n                            <button \n                                onClick={handleExportYoloDataset}\n                                style={{\n                                    backgroundColor: '#7c3aed',\n                                    color: 'white',\n                                    padding: '8px 16px',\n                                    border: 'none',\n                                    borderRadius: '4px',\n                                    cursor: 'pointer'\n                                }}\n                            >\n                                📦 Export YOLO Dataset\n                            </button>\n                        )}\n                    </div>\n                </div>\n\n                <div style={{ \n                    display: 'grid', \n                    gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', \n                    gap: '20px',\n                    marginBottom: '20px'\n                }}>\n                    <div style={{\n                        padding: '15px',\n                        backgroundColor: '#dcfce7',\n                        border: '1px solid #86efac',\n                        borderRadius: '8px'\n                    }}>\n                        <div style={{ fontSize: '18px', fontWeight: 'bold', color: '#059669' }}>\n                            ✅ Successful: {successfulResults.length}\n                        </div>\n                    </div>\n                    <div style={{\n                        padding: '15px',\n                        backgroundColor: '#fee2e2',\n                        border: '1px solid #fca5a5',\n                        borderRadius: '8px'\n                    }}>\n                        <div style={{ fontSize: '18px', fontWeight: 'bold', color: '#dc2626' }}>\n                            ❌ Failed: {failedResults.length}\n                        </div>\n                    </div>\n                </div>\n\n                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(400px, 1fr))', gap: '20px' }}>\n                    {annotatedResults.map((result, index) => (\n                        <div key={index} style={{ \n                            border: '1px solid #e2e8f0', \n                            borderRadius: '8px', \n                            padding: '15px',\n                            backgroundColor: result.success ? '#f9fafb' : '#fef2f2'\n                        }}>\n                            <h4 style={{ margin: '0 0 10px 0' }}>{result.originalName}</h4>\n                            \n                            {result.success ? (\n                                <div>\n                                    <img \n                                        src={result.annotatedUrl} \n                                        alt={`Annotated ${result.originalName}`} \n                                        style={{ width: '100%', borderRadius: '4px', marginBottom: '10px' }}\n                                    />\n                                    \n                                    {result.detections && (\n                                        <div style={{ fontSize: '14px', color: '#6b7280' }}>\n                                            <strong>Detections:</strong> {result.total_detections || result.detections.length}\n                                            {result.detections.map((detection, idx) => (\n                                                <div key={idx} style={{ marginLeft: '10px', fontSize: '12px' }}>\n                                                    • {detection.class}: {(detection.confidence * 100).toFixed(1)}%\n                                                </div>\n                                            ))}\n                                        </div>\n                                    )}\n                                </div>\n                            ) : (\n                                <div style={{ color: '#dc2626' }}>\n                                    Error: {result.error}\n                                </div>\n                            )}\n                        </div>\n                    ))}\n                </div>\n            </div>\n        );\n    };\n\n    return (\n        <div style={{ padding: '20px', maxWidth: '1200px', margin: '0 auto' }}>\n            <h2>🏷️ Image Annotation</h2>\n            \n            <div style={{ marginBottom: '20px' }}>\n                <label style={{ display: 'block', marginBottom: '10px', fontSize: '16px', fontWeight: 'bold' }}>\n                    📁 Select Images:\n                </label>\n                <input \n                    type=\"file\" \n                    multiple \n                    accept=\"image/*\"\n                    onChange={handleFileChange}\n                    style={{ \n                        padding: '10px',\n                        border: '2px dashed #d1d5db',\n                        borderRadius: '8px',\n                        width: '100%',\n                        cursor: 'pointer'\n                    }}\n                />\n                {files.length > 0 && (\n                    <div style={{ marginTop: '10px', fontSize: '14px', color: '#059669' }}>\n                        ✅ {files.length} image(s) selected\n                    </div>\n                )}\n            </div>\n\n            {renderAnnotationTypeSelector()}\n            {renderGroundingDinoOptions()}\n            {renderGuardrailOptions()}\n\n            <div style={{ marginBottom: '30px' }}>\n                <button \n                    onClick={handleAnnotate}\n                    disabled={files.length === 0 || isLoading}\n                    style={{\n                        backgroundColor: files.length === 0 || isLoading ? '#9ca3af' : '#1e3a8a',\n                        color: 'white',\n                        padding: '12px 24px',\n                        border: 'none',\n                        borderRadius: '8px',\n                        fontSize: '16px',\n                        cursor: files.length === 0 || isLoading ? 'not-allowed' : 'pointer'\n                    }}\n                >\n                    {isLoading ? `🔄 Processing... (${processingProgress.current}/${processingProgress.total})` : '🚀 Start Annotation'}\n                </button>\n            </div>\n\n            {renderResults()}\n        </div>\n    );\n}\n\nexport default Annotate;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}