{"ast":null,"code":"var _jsxFileName = \"/Users/truonghaidang/Desktop/open-trainer/frontend/src/components/auto-annotation/AnomalyDetectionStep.js\";\nimport React, { useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction AnomalyDetectionStep({\n  projectId,\n  roiData,\n  onStepComplete\n}) {\n  const [detectionState, setDetectionState] = useState({\n    method: 'mahalanobis',\n    thresholdPercentile: 95.0,\n    processing: false,\n    results: null\n  });\n  const [errors, setErrors] = useState({});\n  const handleSettingChange = (setting, value) => {\n    setDetectionState(prev => ({\n      ...prev,\n      [setting]: value\n    }));\n  };\n  const startAnomalyDetection = async () => {\n    setDetectionState(prev => ({\n      ...prev,\n      processing: true\n    }));\n    setErrors({});\n    try {\n      const formData = new FormData();\n      formData.append('method', detectionState.method);\n      formData.append('threshold_percentile', detectionState.thresholdPercentile);\n      console.log(`üß† Starting anomaly detection with ${detectionState.method} method`);\n      const response = await fetch(`/api/auto-annotation/projects/${projectId}/detect-anomalies`, {\n        method: 'POST',\n        body: formData\n      });\n      const result = await response.json();\n      if (result.status === 'success') {\n        setDetectionState(prev => ({\n          ...prev,\n          results: result\n        }));\n        console.log('‚úÖ Anomaly detection completed:', result);\n      } else {\n        setErrors({\n          detection: result.message || 'Anomaly detection failed'\n        });\n      }\n    } catch (error) {\n      console.error('Anomaly detection failed:', error);\n      setErrors({\n        detection: 'Network error. Please try again.'\n      });\n    } finally {\n      setDetectionState(prev => ({\n        ...prev,\n        processing: false\n      }));\n    }\n  };\n  const handleProceedToNextStep = () => {\n    if (onStepComplete) {\n      onStepComplete(detectionState.results);\n    }\n  };\n  const getAnomalyCount = () => {\n    if (!detectionState.results) return 0;\n    return detectionState.results.results.filter(r => r.image_scores.anomaly_percentage > 5.0 // Consider >5% anomalous patches as anomalous\n    ).length;\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"anomaly-detection-step\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"step-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        children: \"\\uD83E\\uDDE0 Step 2: DINOv2 Anomaly Detection\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Use advanced AI to detect anomalous patterns in your ROI images without manual labeling.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"detection-settings\",\n      children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n        children: \"\\u2699\\uFE0F Detection Settings\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"settings-grid\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"setting-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Detection Method\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: detectionState.method,\n            onChange: e => handleSettingChange('method', e.target.value),\n            disabled: detectionState.processing,\n            children: [/*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"mahalanobis\",\n              children: \"Mahalanobis Distance (Recommended)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 86,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"euclidean\",\n              children: \"Euclidean Distance\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n              value: \"cosine\",\n              children: \"Cosine Distance\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 88,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"setting-help\",\n            children: [detectionState.method === 'mahalanobis' && \"Best for correlated features\", detectionState.method === 'euclidean' && \"Simple distance in feature space\", detectionState.method === 'cosine' && \"Good for texture-based anomalies\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"setting-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"Anomaly Threshold\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 98,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"threshold-control\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"range\",\n              value: detectionState.thresholdPercentile,\n              onChange: e => handleSettingChange('thresholdPercentile', parseFloat(e.target.value)),\n              min: \"90.0\",\n              max: \"99.9\",\n              step: \"0.1\",\n              disabled: detectionState.processing\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 100,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"threshold-value\",\n              children: [detectionState.thresholdPercentile, \"%\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 109,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"setting-help\",\n            children: \"Percentile threshold - higher = fewer anomalies detected\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 111,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"method-explanation\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"How it works:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 13\n          }, this), \" DINOv2 extracts features from your ROI images, builds a model of \\\"normal\\\" patterns, then identifies regions that deviate significantly from normal.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"detection-actions\",\n      children: [errors.detection && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"error-banner\",\n        children: [\"\\u274C \", errors.detection]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"start-detection-button\",\n        onClick: startAnomalyDetection,\n        disabled: detectionState.processing,\n        children: detectionState.processing ? 'üß† Analyzing patterns...' : 'üîç Start Anomaly Detection'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this), detectionState.processing && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"processing-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\uD83D\\uDD04 This may take 30-60 seconds depending on the number of ROI images...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"progress-indicator\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"progress-bar\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"progress-fill indeterminate\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 7\n    }, this), detectionState.results && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"detection-results\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"results-header\",\n        children: /*#__PURE__*/_jsxDEV(\"h5\", {\n          children: \"\\uD83D\\uDCCA Anomaly Detection Results\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"results-summary\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"summary-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"summary-label\",\n            children: \"Images Processed:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"summary-value\",\n            children: detectionState.results.total_images\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 164,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"summary-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"summary-label\",\n            children: \"Anomalies Found:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"summary-value warning\",\n            children: getAnomalyCount()\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"summary-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"summary-label\",\n            children: \"Detection Method:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"summary-value\",\n            children: detectionState.results.method\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"summary-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"summary-label\",\n            children: \"Threshold Used:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"summary-value\",\n            children: [detectionState.results.threshold_percentile, \"%\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"heatmap-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n          children: \"\\uD83D\\uDD25 Anomaly Heatmaps\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"heatmap-grid\",\n          children: detectionState.results.results.slice(0, 8).map((result, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"heatmap-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"heatmap-header\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"image-name\",\n                children: result.image_name.substring(13)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 189,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: `anomaly-score ${result.image_scores.anomaly_percentage > 5.0 ? 'high' : 'low'}`,\n                children: [result.image_scores.anomaly_percentage.toFixed(1), \"%\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 190,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 188,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"heatmap-container\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: `data:image/png;base64,${result.score_map_base64}`,\n                alt: `Heatmap ${index + 1}`,\n                className: \"heatmap-image\",\n                title: `Max Score: ${result.image_scores.max_score.toFixed(3)}`\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 196,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 195,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"heatmap-stats\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"stat\",\n                children: [\"Max: \", result.image_scores.max_score.toFixed(3)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 205,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"stat\",\n                children: [\"Patches: \", result.image_scores.num_anomaly_patches]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 206,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 19\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 13\n        }, this), detectionState.results.results.length > 8 && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"more-results\",\n          children: [\"... and \", detectionState.results.results.length - 8, \" more images\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"global-stats\",\n        children: [/*#__PURE__*/_jsxDEV(\"h6\", {\n          children: \"\\uD83D\\uDCC8 Global Statistics\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stats-grid\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stat-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-label\",\n              children: \"Min Score:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 224,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-value\",\n              children: detectionState.results.global_stats.min_score.toFixed(3)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stat-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-label\",\n              children: \"Max Score:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 228,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-value\",\n              children: detectionState.results.global_stats.max_score.toFixed(3)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 229,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stat-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-label\",\n              children: \"Mean Score:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 232,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-value\",\n              children: detectionState.results.global_stats.mean_score.toFixed(3)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 233,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"stat-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-label\",\n              children: \"Std Dev:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"stat-value\",\n              children: detectionState.results.global_stats.std_score.toFixed(3)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 237,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"next-step-section\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"success-banner\",\n          children: [\"\\u2705 Anomaly detection completed! Ready to generate annotation candidates.\", /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"next-step-button\",\n            onClick: handleProceedToNextStep,\n            style: {\n              marginLeft: '15px',\n              padding: '8px 16px',\n              background: '#28a745',\n              color: 'white',\n              border: 'none',\n              borderRadius: '4px',\n              cursor: 'pointer'\n            },\n            children: \"Proceed to Step 3 \\u2192\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 246,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"step-info\",\n      children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n        children: \"\\u2139\\uFE0F About DINOv2 Anomaly Detection\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"info-points\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"info-point\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"point-icon\",\n            children: \"\\uD83E\\uDD16\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"point-text\",\n            children: \"Uses pretrained vision transformer features (no training required)\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"info-point\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"point-icon\",\n            children: \"\\uD83D\\uDCCA\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"point-text\",\n            children: \"Builds statistical model from your normal ROI images\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 276,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"info-point\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"point-icon\",\n            children: \"\\uD83D\\uDD25\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"point-text\",\n            children: \"Generates heatmaps showing anomalous regions\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"info-point\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"point-icon\",\n            children: \"\\uD83C\\uDFAF\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 283,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"point-text\",\n            children: \"Works without manual defect labeling\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 269,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 5\n  }, this);\n}\nexport default AnomalyDetectionStep;","map":{"version":3,"names":["React","useState","jsxDEV","_jsxDEV","AnomalyDetectionStep","projectId","roiData","onStepComplete","detectionState","setDetectionState","method","thresholdPercentile","processing","results","errors","setErrors","handleSettingChange","setting","value","prev","startAnomalyDetection","formData","FormData","append","console","log","response","fetch","body","result","json","status","detection","message","error","handleProceedToNextStep","getAnomalyCount","filter","r","image_scores","anomaly_percentage","length","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onChange","e","target","disabled","type","parseFloat","min","max","step","onClick","total_images","threshold_percentile","slice","map","index","image_name","substring","toFixed","src","score_map_base64","alt","title","max_score","num_anomaly_patches","global_stats","min_score","mean_score","std_score","style","marginLeft","padding","background","color","border","borderRadius","cursor"],"sources":["/Users/truonghaidang/Desktop/open-trainer/frontend/src/components/auto-annotation/AnomalyDetectionStep.js"],"sourcesContent":["import React, { useState } from 'react';\n\nfunction AnomalyDetectionStep({ projectId, roiData, onStepComplete }) {\n  const [detectionState, setDetectionState] = useState({\n    method: 'mahalanobis',\n    thresholdPercentile: 95.0,\n    processing: false,\n    results: null\n  });\n  const [errors, setErrors] = useState({});\n\n  const handleSettingChange = (setting, value) => {\n    setDetectionState(prev => ({\n      ...prev,\n      [setting]: value\n    }));\n  };\n\n  const startAnomalyDetection = async () => {\n    setDetectionState(prev => ({ ...prev, processing: true }));\n    setErrors({});\n\n    try {\n      const formData = new FormData();\n      formData.append('method', detectionState.method);\n      formData.append('threshold_percentile', detectionState.thresholdPercentile);\n\n      console.log(`üß† Starting anomaly detection with ${detectionState.method} method`);\n      \n      const response = await fetch(`/api/auto-annotation/projects/${projectId}/detect-anomalies`, {\n        method: 'POST',\n        body: formData\n      });\n\n      const result = await response.json();\n\n      if (result.status === 'success') {\n        setDetectionState(prev => ({\n          ...prev,\n          results: result\n        }));\n        console.log('‚úÖ Anomaly detection completed:', result);\n      } else {\n        setErrors({ detection: result.message || 'Anomaly detection failed' });\n      }\n    } catch (error) {\n      console.error('Anomaly detection failed:', error);\n      setErrors({ detection: 'Network error. Please try again.' });\n    } finally {\n      setDetectionState(prev => ({ ...prev, processing: false }));\n    }\n  };\n\n  const handleProceedToNextStep = () => {\n    if (onStepComplete) {\n      onStepComplete(detectionState.results);\n    }\n  };\n\n  const getAnomalyCount = () => {\n    if (!detectionState.results) return 0;\n    return detectionState.results.results.filter(r => \n      r.image_scores.anomaly_percentage > 5.0 // Consider >5% anomalous patches as anomalous\n    ).length;\n  };\n\n  return (\n    <div className=\"anomaly-detection-step\">\n      <div className=\"step-header\">\n        <h4>üß† Step 2: DINOv2 Anomaly Detection</h4>\n        <p>Use advanced AI to detect anomalous patterns in your ROI images without manual labeling.</p>\n      </div>\n\n      {/* Detection Settings */}\n      <div className=\"detection-settings\">\n        <h5>‚öôÔ∏è Detection Settings</h5>\n        \n        <div className=\"settings-grid\">\n          <div className=\"setting-item\">\n            <label>Detection Method</label>\n            <select\n              value={detectionState.method}\n              onChange={(e) => handleSettingChange('method', e.target.value)}\n              disabled={detectionState.processing}\n            >\n              <option value=\"mahalanobis\">Mahalanobis Distance (Recommended)</option>\n              <option value=\"euclidean\">Euclidean Distance</option>\n              <option value=\"cosine\">Cosine Distance</option>\n            </select>\n            <span className=\"setting-help\">\n              {detectionState.method === 'mahalanobis' && \"Best for correlated features\"}\n              {detectionState.method === 'euclidean' && \"Simple distance in feature space\"}\n              {detectionState.method === 'cosine' && \"Good for texture-based anomalies\"}\n            </span>\n          </div>\n          \n          <div className=\"setting-item\">\n            <label>Anomaly Threshold</label>\n            <div className=\"threshold-control\">\n              <input\n                type=\"range\"\n                value={detectionState.thresholdPercentile}\n                onChange={(e) => handleSettingChange('thresholdPercentile', parseFloat(e.target.value))}\n                min=\"90.0\"\n                max=\"99.9\"\n                step=\"0.1\"\n                disabled={detectionState.processing}\n              />\n              <span className=\"threshold-value\">{detectionState.thresholdPercentile}%</span>\n            </div>\n            <span className=\"setting-help\">\n              Percentile threshold - higher = fewer anomalies detected\n            </span>\n          </div>\n        </div>\n        \n        <div className=\"method-explanation\">\n          <p>\n            <strong>How it works:</strong> DINOv2 extracts features from your ROI images, \n            builds a model of \"normal\" patterns, then identifies regions that deviate significantly from normal.\n          </p>\n        </div>\n      </div>\n\n      {/* Action Button */}\n      <div className=\"detection-actions\">\n        {errors.detection && (\n          <div className=\"error-banner\">\n            ‚ùå {errors.detection}\n          </div>\n        )}\n        \n        <button\n          className=\"start-detection-button\"\n          onClick={startAnomalyDetection}\n          disabled={detectionState.processing}\n        >\n          {detectionState.processing \n            ? 'üß† Analyzing patterns...' \n            : 'üîç Start Anomaly Detection'\n          }\n        </button>\n        \n        {detectionState.processing && (\n          <div className=\"processing-info\">\n            <p>üîÑ This may take 30-60 seconds depending on the number of ROI images...</p>\n            <div className=\"progress-indicator\">\n              <div className=\"progress-bar\">\n                <div className=\"progress-fill indeterminate\"></div>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Results */}\n      {detectionState.results && (\n        <div className=\"detection-results\">\n          <div className=\"results-header\">\n            <h5>üìä Anomaly Detection Results</h5>\n          </div>\n          \n          <div className=\"results-summary\">\n            <div className=\"summary-item\">\n              <span className=\"summary-label\">Images Processed:</span>\n              <span className=\"summary-value\">{detectionState.results.total_images}</span>\n            </div>\n            <div className=\"summary-item\">\n              <span className=\"summary-label\">Anomalies Found:</span>\n              <span className=\"summary-value warning\">{getAnomalyCount()}</span>\n            </div>\n            <div className=\"summary-item\">\n              <span className=\"summary-label\">Detection Method:</span>\n              <span className=\"summary-value\">{detectionState.results.method}</span>\n            </div>\n            <div className=\"summary-item\">\n              <span className=\"summary-label\">Threshold Used:</span>\n              <span className=\"summary-value\">{detectionState.results.threshold_percentile}%</span>\n            </div>\n          </div>\n\n          {/* Heatmap Grid */}\n          <div className=\"heatmap-section\">\n            <h6>üî• Anomaly Heatmaps</h6>\n            <div className=\"heatmap-grid\">\n              {detectionState.results.results.slice(0, 8).map((result, index) => (\n                <div key={index} className=\"heatmap-item\">\n                  <div className=\"heatmap-header\">\n                    <span className=\"image-name\">{result.image_name.substring(13)}</span>\n                    <span className={`anomaly-score ${result.image_scores.anomaly_percentage > 5.0 ? 'high' : 'low'}`}>\n                      {result.image_scores.anomaly_percentage.toFixed(1)}%\n                    </span>\n                  </div>\n                  \n                  <div className=\"heatmap-container\">\n                    <img\n                      src={`data:image/png;base64,${result.score_map_base64}`}\n                      alt={`Heatmap ${index + 1}`}\n                      className=\"heatmap-image\"\n                      title={`Max Score: ${result.image_scores.max_score.toFixed(3)}`}\n                    />\n                  </div>\n                  \n                  <div className=\"heatmap-stats\">\n                    <div className=\"stat\">Max: {result.image_scores.max_score.toFixed(3)}</div>\n                    <div className=\"stat\">Patches: {result.image_scores.num_anomaly_patches}</div>\n                  </div>\n                </div>\n              ))}\n            </div>\n            \n            {detectionState.results.results.length > 8 && (\n              <p className=\"more-results\">\n                ... and {detectionState.results.results.length - 8} more images\n              </p>\n            )}\n          </div>\n\n          {/* Global Statistics */}\n          <div className=\"global-stats\">\n            <h6>üìà Global Statistics</h6>\n            <div className=\"stats-grid\">\n              <div className=\"stat-item\">\n                <span className=\"stat-label\">Min Score:</span>\n                <span className=\"stat-value\">{detectionState.results.global_stats.min_score.toFixed(3)}</span>\n              </div>\n              <div className=\"stat-item\">\n                <span className=\"stat-label\">Max Score:</span>\n                <span className=\"stat-value\">{detectionState.results.global_stats.max_score.toFixed(3)}</span>\n              </div>\n              <div className=\"stat-item\">\n                <span className=\"stat-label\">Mean Score:</span>\n                <span className=\"stat-value\">{detectionState.results.global_stats.mean_score.toFixed(3)}</span>\n              </div>\n              <div className=\"stat-item\">\n                <span className=\"stat-label\">Std Dev:</span>\n                <span className=\"stat-value\">{detectionState.results.global_stats.std_score.toFixed(3)}</span>\n              </div>\n            </div>\n          </div>\n\n          {/* Next Step Button */}\n          <div className=\"next-step-section\">\n            <div className=\"success-banner\">\n              ‚úÖ Anomaly detection completed! Ready to generate annotation candidates.\n              <button\n                className=\"next-step-button\"\n                onClick={handleProceedToNextStep}\n                style={{ \n                  marginLeft: '15px', \n                  padding: '8px 16px', \n                  background: '#28a745', \n                  color: 'white', \n                  border: 'none', \n                  borderRadius: '4px', \n                  cursor: 'pointer' \n                }}\n              >\n                Proceed to Step 3 ‚Üí\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Info Section */}\n      <div className=\"step-info\">\n        <h5>‚ÑπÔ∏è About DINOv2 Anomaly Detection</h5>\n        <div className=\"info-points\">\n          <div className=\"info-point\">\n            <span className=\"point-icon\">ü§ñ</span>\n            <span className=\"point-text\">Uses pretrained vision transformer features (no training required)</span>\n          </div>\n          <div className=\"info-point\">\n            <span className=\"point-icon\">üìä</span>\n            <span className=\"point-text\">Builds statistical model from your normal ROI images</span>\n          </div>\n          <div className=\"info-point\">\n            <span className=\"point-icon\">üî•</span>\n            <span className=\"point-text\">Generates heatmaps showing anomalous regions</span>\n          </div>\n          <div className=\"info-point\">\n            <span className=\"point-icon\">üéØ</span>\n            <span className=\"point-text\">Works without manual defect labeling</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default AnomalyDetectionStep;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}